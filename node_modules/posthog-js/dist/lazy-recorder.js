!function(){"use strict";var t="undefined"!=typeof window?window:void 0,e="undefined"!=typeof globalThis?globalThis:t;"undefined"==typeof self&&(e.self=e),"undefined"==typeof File&&(e.File=function(){});var r=Array.prototype.forEach,i=null==e?void 0:e.navigator,n=null==e?void 0:e.document;null==e||e.location,null==e||e.fetch,null!=e&&e.XMLHttpRequest&&"withCredentials"in new e.XMLHttpRequest&&e.XMLHttpRequest,null==e||e.AbortController,null==i||i.userAgent;var o=null!=t?t:{};function s(t,e,r,i,n,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(i,n)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var o=t.apply(e,r);function a(t){s(o,i,n,a,u,"next",t)}function u(t){s(o,i,n,a,u,"throw",t)}a(void 0)}))}}function u(){return u=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)({}).hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},u.apply(null,arguments)}var l=function(t){return t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t}({}),d=function(t){return t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t}({});var c=function(t){return t.trim()},h=Array.isArray,v=Object.prototype,f=v.hasOwnProperty,m=v.toString,p=h||function(t){return"[object Array]"===m.call(t)},g=t=>"function"==typeof t,I=t=>t===Object(t)&&!p(t),y=t=>void 0===t,b=t=>"[object String]"==m.call(t),C=t=>null===t,w=t=>y(t)||C(t),S=t=>"[object Number]"==m.call(t)&&t==t,k=t=>"[object Boolean]"===m.call(t),A=t=>t instanceof FormData;function N(t,e,r,i,n){return e>r&&(i.warn("min cannot be greater than max."),e=r),S(t)?t>r?(i.warn(" cannot be  greater than max: "+r+". Using max value instead."),r):t<e?(i.warn(" cannot be less than min: "+e+". Using min value instead."),e):t:(i.warn(" must be a number. using max or fallback. max: "+r+", fallback: "+n),N(n||r,e,r,i))}class R{constructor(t){this.t={},this.i=t.i,this.o=N(t.bucketSize,0,100,t.u),this.h=N(t.refillRate,0,this.o,t.u),this.m=N(t.refillInterval,0,864e5,t.u)}I(t,e){var r=e-t.lastAccess,i=Math.floor(r/this.m);if(i>0){var n=i*this.h;t.tokens=Math.min(t.tokens+n,this.o),t.lastAccess=t.lastAccess+i*this.m}}consumeRateLimit(t){var e,r=Date.now(),i=String(t),n=this.t[i];return n?this.I(n,r):(n={tokens:this.o,lastAccess:r},this.t[i]=n),0===n.tokens||(n.tokens--,0===n.tokens&&(null==(e=this.i)||e.call(this,t)),0===n.tokens)}stop(){this.t={}}}var T={LIB_VERSION:"1.336.4"},_=function(e,r){var{debugEnabled:i}=void 0===r?{}:r,n={C:function(r){if(t&&(o.POSTHOG_DEBUG||i)&&!y(t.console)&&t.console){for(var n=("__rrweb_original__"in t.console[r]?t.console[r].__rrweb_original__:t.console[r]),s=arguments.length,a=new Array(s>1?s-1:0),u=1;u<s;u++)a[u-1]=arguments[u];n(e,...a)}},info:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.C("log",...e)},warn:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.C("warn",...e)},error:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];n.C("error",...e)},critical:function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];console.error(e,...r)},uninitializedWarning:t=>{n.error("You must initialize PostHog before calling "+t)},createLogger:(t,r)=>_(e+" "+t,r)};return n},M=_("[PostHog.js]"),F=M.createLogger,B={};function O(t,e,i){if(!w(t)){if(p(t))return function(t,e,i){if(p(t))if(r&&t.forEach===r)t.forEach(e,i);else if("length"in t&&t.length===+t.length)for(var n=0,o=t.length;n<o;n++)if(n in t&&e.call(i,t[n],n)===B)return}(t,e,i);if(A(t)){for(var n of t.entries())if(e.call(i,n[1],n[0])===B)return}else for(var o in t)if(f.call(t,o)&&e.call(i,t[o],o)===B)return}}function x(t,e,r,i){var{capture:n=!1,passive:o=!0}={};null==t||t.addEventListener(e,r,{capture:n,passive:o})}var Z=["localhost","127.0.0.1"],Y=t=>{var e=null==n?void 0:n.createElement("a");return y(e)?null:(e.href=t,e)},E=function(t,e){var r,i;void 0===e&&(e="&");var n=[];return O(t,(function(t,e){y(t)||y(e)||"undefined"===e||(r=encodeURIComponent((t=>t instanceof File)(t)?t.name:t.toString()),i=encodeURIComponent(e),n[n.length]=i+"="+r)})),n.join(e)},G="$session_is_sampled",L="$session_past_minimum_duration",W="$session_recording_url_trigger_activated_session",D="$session_recording_event_trigger_activated_session",V="$debug_first_full_snapshot_timestamp",X=new RegExp("(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})"),z=new RegExp("(\\d{3}-?\\d{2}-?\\d{4})");var J="[SessionRecording]",K="redacted",H={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:t=>t,recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6,payloadHostDenyList:[".lr-ingest.io",".ingest.sentry.io",".clarity.ms","analytics.google.com","bam.nr-data.net"]},j=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],U=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],P=["/s/","/e/","/i/"];function q(t,e,r,i){if(w(t))return t;var n=(null==e?void 0:e["content-length"])||function(t){return new Blob([t]).size}(t);return b(n)&&(n=parseInt(n)),n>r?J+" "+i+" body too large to record ("+n+" bytes)":t}function Q(t,e){if(w(t))return t;var r=t;return function(t,e){if(w(t))return!1;if(b(t)){if(t=c(t),X.test((t||"").replace(/[- ]/g,"")))return!1;if(z.test(t))return!1}return!0}(r)||(r=J+" "+e+" body "+K),O(U,(t=>{var i,n;null!=(i=r)&&i.length&&-1!==(null==(n=r)?void 0:n.indexOf(t))&&(r=J+" "+e+" body "+K+" as might contain: "+t)})),r}var tt=(t,e)=>{var r,i,n,o={payloadSizeLimitBytes:H.payloadSizeLimitBytes,performanceEntryTypeToObserve:[...H.performanceEntryTypeToObserve],payloadHostDenyList:[...e.payloadHostDenyList||[],...H.payloadHostDenyList]},s=!1!==t.session_recording.recordHeaders&&e.recordHeaders,a=!1!==t.session_recording.recordBody&&e.recordBody,l=!1!==t.capture_performance&&e.recordPerformance,d=(r=o,n=Math.min(1e6,null!==(i=r.payloadSizeLimitBytes)&&void 0!==i?i:1e6),t=>(null!=t&&t.requestBody&&(t.requestBody=q(t.requestBody,t.requestHeaders,n,"Request")),null!=t&&t.responseBody&&(t.responseBody=q(t.responseBody,t.responseHeaders,n,"Response")),t)),c=e=>{return d(((t,e)=>{var r,i=Y(t.name),n=0===e.indexOf("http")?null==(r=Y(e))?void 0:r.pathname:e;"/"===n&&(n="");var o=null==i?void 0:i.pathname.replace(n||"","");if(!(i&&o&&P.some((t=>0===o.indexOf(t)))))return t})((i=(r=e).requestHeaders,w(i)||O(Object.keys(null!=i?i:{}),(t=>{j.includes(t.toLowerCase())&&(i[t]=K)})),r),t.api_host));var r,i},h=g(t.session_recording.maskNetworkRequestFn);return h&&g(t.session_recording.maskCapturedNetworkRequestFn)&&M.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),h&&(t.session_recording.maskCapturedNetworkRequestFn=e=>{var r=t.session_recording.maskNetworkRequestFn({url:e.name});return u({},e,{name:null==r?void 0:r.url})}),o.maskRequestFn=g(t.session_recording.maskCapturedNetworkRequestFn)?e=>{var r,i=c(e);return i&&null!==(r=null==t.session_recording.maskCapturedNetworkRequestFn?void 0:t.session_recording.maskCapturedNetworkRequestFn(i))&&void 0!==r?r:void 0}:t=>function(t){if(!y(t))return t.requestBody=Q(t.requestBody,"Request"),t.responseBody=Q(t.responseBody,"Response"),t}(c(t)),u({},H,o,{recordHeaders:s,recordBody:a,recordPerformance:l,recordInitialRequests:l})},et="disabled",rt="sampled",it="active",nt="buffering",ot="paused",st="trigger",at=st+"_activated",ut=st+"_pending",lt=st+"_"+et;function dt(t,e,r){return e.some((e=>{var i;return"regex"===e.matching&&(null!==(i=null==r?void 0:r.get(e.url))&&void 0!==i?i:new RegExp(e.url)).test(t)}))}class ct{constructor(t){this.S=t}triggerStatus(t){var e=this.S.map((e=>e.triggerStatus(t)));return e.includes(at)?at:e.includes(ut)?ut:lt}stop(){this.S.forEach((t=>t.stop()))}}class ht{constructor(t){this.S=t}triggerStatus(t){var e=new Set;for(var r of this.S)e.add(r.triggerStatus(t));switch(e.delete(lt),e.size){case 0:return lt;case 1:return Array.from(e)[0];default:return ut}}stop(){this.S.forEach((t=>t.stop()))}}class vt{triggerStatus(){return ut}stop(){}}var ft=t=>"sessionRecording"in t;class mt{constructor(t){this.k=[],this.A=[],this.N=new Map,this.R=new Map,this.T="",this.urlBlocked=!1,this._instance=t}onConfig(t){var e,r;this.k=(ft(t)?I(t.sessionRecording)?null==(e=t.sessionRecording)?void 0:e.urlTriggers:[]:null==t?void 0:t.urlTriggers)||[],this.A=(ft(t)?I(t.sessionRecording)?null==(r=t.sessionRecording)?void 0:r.urlBlocklist:[]:null==t?void 0:t.urlBlocklist)||[],this.M()}M(){for(var t of(this.N.clear(),this.R.clear(),this.k))if("regex"===t.matching&&!this.N.has(t.url))try{this.N.set(t.url,new RegExp(t.url))}catch(e){M.error("Invalid URL trigger regex pattern:",t.url,e)}for(var e of this.A)if("regex"===e.matching&&!this.R.has(e.url))try{this.R.set(e.url,new RegExp(e.url))}catch(t){M.error("Invalid URL blocklist regex pattern:",e.url,t)}}onRemoteConfig(t){this.onConfig(t)}F(t){var e;return 0===this.k.length?lt:(null==(e=this._instance)?void 0:e.get_property(W))===t?at:ut}triggerStatus(t){var e=this.F(t),r=e===at?at:e===ut?ut:lt;return this._instance.register_for_session({$sdk_debug_replay_url_trigger_status:r}),r}checkUrlTriggerConditions(e,r,i,n){if(void 0!==t&&t.location.href){var o=t.location.href;if(o!==this.T){this.T=o;var s=this.urlBlocked,a=dt(o,this.A,this.R);if(!s||!a){a&&!s?e():!a&&s&&r();var u=this.F(n)===at,l=dt(o,this.k,this.N);!u&&l&&i("url")}}}}stop(){this.T=""}}class pt{constructor(t){this.linkedFlag=null,this.linkedFlagSeen=!1,this.B=()=>{},this._instance=t}triggerStatus(){var t=ut;return w(this.linkedFlag)&&(t=lt),this.linkedFlagSeen&&(t=at),this._instance.register_for_session({$sdk_debug_replay_linked_flag_trigger_status:t}),t}onConfig(t,e){var r;if(this.linkedFlag=(ft(t)?I(t.sessionRecording)?null==(r=t.sessionRecording)?void 0:r.linkedFlag:null:null==t?void 0:t.linkedFlag)||null,!w(this.linkedFlag)&&!this.linkedFlagSeen){var i=b(this.linkedFlag)?this.linkedFlag:this.linkedFlag.flag,n=b(this.linkedFlag)?null:this.linkedFlag.variant;this.B=this._instance.onFeatureFlags(((t,r)=>{var o=!1;if(I(r)&&i in r){var s=r[i];o=k(s)?!0===s:n?s===n:!!s}this.linkedFlagSeen=o,o&&e(i,n)}))}}onRemoteConfig(t,e){this.onConfig(t,e)}stop(){this.B()}}class gt{constructor(t){this.O=[],this._instance=t}onConfig(t){var e;this.O=(ft(t)?I(t.sessionRecording)?null==(e=t.sessionRecording)?void 0:e.eventTriggers:[]:null==t?void 0:t.eventTriggers)||[]}onRemoteConfig(t){this.onConfig(t)}Z(t){var e;return 0===this.O.length?lt:(null==(e=this._instance)?void 0:e.get_property(D))===t?at:ut}triggerStatus(t){var e=this.Z(t),r=e===at?at:e===ut?ut:lt;return this._instance.register_for_session({$sdk_debug_replay_event_trigger_status:r}),r}stop(){}}function It(t){return t.isRecordingEnabled?nt:et}function yt(t){if(!t.receivedFlags)return nt;if(!t.isRecordingEnabled)return et;if(t.urlTriggerMatching.urlBlocked)return ot;var e=!0===t.isSampled,r=new ct([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId);return e?rt:r===at?it:r===ut?nt:!1===t.isSampled?et:it}function bt(t){if(!t.receivedFlags)return nt;if(!t.isRecordingEnabled)return et;if(t.urlTriggerMatching.urlBlocked)return ot;var e=new ht([t.eventTriggerMatching,t.urlTriggerMatching,t.linkedFlagMatching]).triggerStatus(t.sessionId),r=e!==lt,i=k(t.isSampled);return r&&e===ut?nt:r&&e===lt||i&&!t.isSampled?et:!0===t.isSampled?rt:it}function Ct(t){var e,r;return(null==(e=JSON.stringify(t,(r=[],function(t,e){if(I(e)){for(;r.length>0&&r[r.length-1]!==this;)r.pop();return r.includes(e)?"[Circular]":(r.push(e),e)}return e})))?void 0:e.length)||0}var wt=Uint8Array,St=Uint16Array,kt=Uint32Array,At=new wt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Nt=new wt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rt=new wt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tt=function(t,e){for(var r=new St(31),i=0;i<31;++i)r[i]=e+=1<<t[i-1];var n=new kt(r[30]);for(i=1;i<30;++i)for(var o=r[i];o<r[i+1];++o)n[o]=o-r[i]<<5|i;return[r,n]},_t=Tt(At,2),Mt=_t[0],Ft=_t[1];Mt[28]=258,Ft[258]=28;for(var Bt=Tt(Nt,0)[1],Ot=new St(32768),xt=0;xt<32768;++xt){var Zt=(43690&xt)>>>1|(21845&xt)<<1;Zt=(61680&(Zt=(52428&Zt)>>>2|(13107&Zt)<<2))>>>4|(3855&Zt)<<4,Ot[xt]=((65280&Zt)>>>8|(255&Zt)<<8)>>>1}var Yt=function(t,e,r){for(var i=t.length,n=0,o=new St(e);n<i;++n)++o[t[n]-1];var s,a=new St(e);for(n=0;n<e;++n)a[n]=a[n-1]+o[n-1]<<1;if(r){s=new St(1<<e);var u=15-e;for(n=0;n<i;++n)if(t[n])for(var l=n<<4|t[n],d=e-t[n],c=a[t[n]-1]++<<d,h=c|(1<<d)-1;c<=h;++c)s[Ot[c]>>>u]=l}else for(s=new St(i),n=0;n<i;++n)s[n]=Ot[a[t[n]-1]++]>>>15-t[n];return s},Et=new wt(288);for(xt=0;xt<144;++xt)Et[xt]=8;for(xt=144;xt<256;++xt)Et[xt]=9;for(xt=256;xt<280;++xt)Et[xt]=7;for(xt=280;xt<288;++xt)Et[xt]=8;var Gt=new wt(32);for(xt=0;xt<32;++xt)Gt[xt]=5;var Lt=Yt(Et,9,0),Wt=Yt(Gt,5,0),Dt=function(t){return(t/8>>0)+(7&t&&1)},Vt=function(t,e,r){(null==r||r>t.length)&&(r=t.length);var i=new(t instanceof St?St:t instanceof kt?kt:wt)(r-e);return i.set(t.subarray(e,r)),i},Xt=function(t,e,r){r<<=7&e;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8},zt=function(t,e,r){r<<=7&e;var i=e/8>>0;t[i]|=r,t[i+1]|=r>>>8,t[i+2]|=r>>>16},Jt=function(t,e){for(var r=[],i=0;i<t.length;++i)t[i]&&r.push({s:i,f:t[i]});var n=r.length,o=r.slice();if(!n)return[new wt(0),0];if(1==n){var s=new wt(r[0].s+1);return s[r[0].s]=1,[s,1]}r.sort((function(t,e){return t.f-e.f})),r.push({s:-1,f:25001});var a=r[0],u=r[1],l=0,d=1,c=2;for(r[0]={s:-1,f:a.f+u.f,l:a,r:u};d!=n-1;)a=r[r[l].f<r[c].f?l++:c++],u=r[l!=d&&r[l].f<r[c].f?l++:c++],r[d++]={s:-1,f:a.f+u.f,l:a,r:u};var h=o[0].s;for(i=1;i<n;++i)o[i].s>h&&(h=o[i].s);var v=new St(h+1),f=Kt(r[d-1],v,0);if(f>e){i=0;var m=0,p=f-e,g=1<<p;for(o.sort((function(t,e){return v[e.s]-v[t.s]||t.f-e.f}));i<n;++i){var I=o[i].s;if(!(v[I]>e))break;m+=g-(1<<f-v[I]),v[I]=e}for(m>>>=p;m>0;){var y=o[i].s;v[y]<e?m-=1<<e-v[y]++-1:++i}for(;i>=0&&m;--i){var b=o[i].s;v[b]==e&&(--v[b],++m)}f=e}return[new wt(v),f]},Kt=function(t,e,r){return-1==t.s?Math.max(Kt(t.l,e,r+1),Kt(t.r,e,r+1)):e[t.s]=r},Ht=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new St(++e),i=0,n=t[0],o=1,s=function(t){r[i++]=t},a=1;a<=e;++a)if(t[a]==n&&a!=e)++o;else{if(!n&&o>2){for(;o>138;o-=138)s(32754);o>2&&(s(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(s(n),--o;o>6;o-=6)s(8304);o>2&&(s(o-3<<5|8208),o=0)}for(;o--;)s(n);o=1,n=t[a]}return[r.subarray(0,i),e]},jt=function(t,e){for(var r=0,i=0;i<e.length;++i)r+=t[i]*e[i];return r},Ut=function(t,e,r){var i=r.length,n=Dt(e+2);t[n]=255&i,t[n+1]=i>>>8,t[n+2]=255^t[n],t[n+3]=255^t[n+1];for(var o=0;o<i;++o)t[n+o+4]=r[o];return 8*(n+4+i)},Pt=function(t,e,r,i,n,o,s,a,u,l,d){Xt(e,d++,r),++n[256];for(var c=Jt(n,15),h=c[0],v=c[1],f=Jt(o,15),m=f[0],p=f[1],g=Ht(h),I=g[0],y=g[1],b=Ht(m),C=b[0],w=b[1],S=new St(19),k=0;k<I.length;++k)S[31&I[k]]++;for(k=0;k<C.length;++k)S[31&C[k]]++;for(var A=Jt(S,7),N=A[0],R=A[1],T=19;T>4&&!N[Rt[T-1]];--T);var _,M,F,B,O=l+5<<3,x=jt(n,Et)+jt(o,Gt)+s,Z=jt(n,h)+jt(o,m)+s+14+3*T+jt(S,N)+(2*S[16]+3*S[17]+7*S[18]);if(O<=x&&O<=Z)return Ut(e,d,t.subarray(u,u+l));if(Xt(e,d,1+(Z<x)),d+=2,Z<x){_=Yt(h,v,0),M=h,F=Yt(m,p,0),B=m;var Y=Yt(N,R,0);Xt(e,d,y-257),Xt(e,d+5,w-1),Xt(e,d+10,T-4),d+=14;for(k=0;k<T;++k)Xt(e,d+3*k,N[Rt[k]]);d+=3*T;for(var E=[I,C],G=0;G<2;++G){var L=E[G];for(k=0;k<L.length;++k){var W=31&L[k];Xt(e,d,Y[W]),d+=N[W],W>15&&(Xt(e,d,L[k]>>>5&127),d+=L[k]>>>12)}}}else _=Lt,M=Et,F=Wt,B=Gt;for(k=0;k<a;++k)if(i[k]>255){W=i[k]>>>18&31;zt(e,d,_[W+257]),d+=M[W+257],W>7&&(Xt(e,d,i[k]>>>23&31),d+=At[W]);var D=31&i[k];zt(e,d,F[D]),d+=B[D],D>3&&(zt(e,d,i[k]>>>5&8191),d+=Nt[D])}else zt(e,d,_[i[k]]),d+=M[i[k]];return zt(e,d,_[256]),d+M[256]},qt=new kt([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Qt=function(){for(var t=new kt(256),e=0;e<256;++e){for(var r=e,i=9;--i;)r=(1&r&&3988292384)^r>>>1;t[e]=r}return t}(),$t=function(){var t=4294967295;return{p:function(e){for(var r=t,i=0;i<e.length;++i)r=Qt[255&r^e[i]]^r>>>8;t=r},d:function(){return 4294967295^t}}},te=function(t,e,r,i,n){return function(t,e,r,i,n,o){var s=t.length,a=new wt(i+s+5*(1+Math.floor(s/7e3))+n),u=a.subarray(i,a.length-n),l=0;if(!e||s<8)for(var d=0;d<=s;d+=65535){var c=d+65535;c<s?l=Ut(u,l,t.subarray(d,c)):(u[d]=o,l=Ut(u,l,t.subarray(d,s)))}else{for(var h=qt[e-1],v=h>>>13,f=8191&h,m=(1<<r)-1,p=new St(32768),g=new St(m+1),I=Math.ceil(r/3),y=2*I,b=function(e){return(t[e]^t[e+1]<<I^t[e+2]<<y)&m},C=new kt(25e3),w=new St(288),S=new St(32),k=0,A=0,N=(d=0,0),R=0,T=0;d<s;++d){var _=b(d),M=32767&d,F=g[_];if(p[M]=F,g[_]=M,R<=d){var B=s-d;if((k>7e3||N>24576)&&B>423){l=Pt(t,u,0,C,w,S,A,N,T,d-T,l),N=k=A=0,T=d;for(var O=0;O<286;++O)w[O]=0;for(O=0;O<30;++O)S[O]=0}var x=2,Z=0,Y=f,E=M-F&32767;if(B>2&&_==b(d-E))for(var G=Math.min(v,B)-1,L=Math.min(32767,d),W=Math.min(258,B);E<=L&&--Y&&M!=F;){if(t[d+x]==t[d+x-E]){for(var D=0;D<W&&t[d+D]==t[d+D-E];++D);if(D>x){if(x=D,Z=E,D>G)break;var V=Math.min(E,D-2),X=0;for(O=0;O<V;++O){var z=d-E+O+32768&32767,J=z-p[z]+32768&32767;J>X&&(X=J,F=z)}}}E+=(M=F)-(F=p[M])+32768&32767}if(Z){C[N++]=268435456|Ft[x]<<18|Bt[Z];var K=31&Ft[x],H=31&Bt[Z];A+=At[K]+Nt[H],++w[257+K],++S[H],R=d+x,++k}else C[N++]=t[d],++w[t[d]]}}l=Pt(t,u,o,C,w,S,A,N,T,d-T,l)}return Vt(a,0,i+Dt(l)+n)}(t,null==e.level?6:e.level,null==e.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):12+e.mem,r,i,!0)},ee=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},re=function(t,e){var r=e.filename;if(t[0]=31,t[1]=139,t[2]=8,t[8]=e.level<2?4:9==e.level?2:0,t[9]=3,0!=e.mtime&&ee(t,4,Math.floor(new Date(e.mtime||Date.now())/1e3)),r){t[3]=8;for(var i=0;i<=r.length;++i)t[i+10]=r.charCodeAt(i)}},ie=function(t){return 10+(t.filename&&t.filename.length+1||0)};class ne{constructor(t,e){var r,i;void 0===e&&(e={}),this.Y={},this.G=t=>{if(!this.Y[t]){var e,r;this.Y[t]=!0;var i=this.L(t);null==(e=(r=this.W).onBlockedNode)||e.call(r,t,i)}},this.D=t=>{var e=this.L(t);if("svg"!==(null==e?void 0:e.nodeName)&&e instanceof Element){var r=e.closest("svg");if(r)return[this._rrweb.mirror.getId(r),r]}return[t,e]},this.L=t=>this._rrweb.mirror.getNode(t),this.V=t=>{var e,r,i,n,o,s,a,u;return(null!==(e=null==(r=t.removes)?void 0:r.length)&&void 0!==e?e:0)+(null!==(i=null==(n=t.attributes)?void 0:n.length)&&void 0!==i?i:0)+(null!==(o=null==(s=t.texts)?void 0:s.length)&&void 0!==o?o:0)+(null!==(a=null==(u=t.adds)?void 0:u.length)&&void 0!==a?a:0)},this.throttleMutations=t=>{if(3!==t.type||0!==t.data.source)return t;var e=t.data,r=this.V(e);e.attributes&&(e.attributes=e.attributes.filter((t=>{var[e]=this.D(t.id);return!this.X.consumeRateLimit(e)&&t})));var i=this.V(e);return 0!==i||r===i?t:void 0},this._rrweb=t,this.W=e,this.X=new R({bucketSize:null!==(r=this.W.bucketSize)&&void 0!==r?r:100,refillRate:null!==(i=this.W.refillRate)&&void 0!==i?i:10,refillInterval:1e3,i:this.G,u:M})}reset(){this.Y={}}stop(){this.X.stop(),this.reset()}}function oe(t,e){return function(t){for(var e=0,r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return Math.abs(e)}(t)%100<N(100*e,0,100,M)}var se="$sess_rec_flush_size";class ae{constructor(t){if(!t.persistence)throw new Error("it is not valid to not have persistence and be this far into setting up the application");this.J=t.get_property.bind(t),this.K=t.persistence.set_property.bind(t.persistence)}trackSize(t){var e=(Number(this.J(se))||0)+t;this.K(se,e)}reset(){return this.K(se,0)}get currentTrackedSize(){return Number(this.J(se))||0}}var ue=3e5,le="[SessionRecording]",de=F(le),ce=[d.MouseMove,d.MouseInteraction,d.Scroll,d.ViewportResize,d.Input,d.TouchMove,d.MediaInteraction,d.Drag],he=t=>({rrwebMethod:t,enqueuedAt:Date.now(),attempt:1});function ve(){var t;return null==o||null==(t=o.__PosthogExtensions__)||null==(t=t.rrweb)?void 0:t.record}function fe(t){return function(t,e){for(var r="",i=0;i<t.length;){var n=t[i++];r+=String.fromCharCode(n)}return r}(function(t,e){void 0===e&&(e={});var r=$t(),i=t.length;r.p(t);var n=te(t,e,ie(e),8),o=n.length;return re(n,e),ee(n,o-8,r.d()),ee(n,o-4,i),n}(function(t,e){var r=t.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(t);for(var i=new wt(t.length+(t.length>>>1)),n=0,o=function(t){i[n++]=t},s=0;s<r;++s){if(n+5>i.length){var a=new wt(n+8+(r-s<<1));a.set(i),i=a}var u=t.charCodeAt(s);u<128||e?o(u):u<2048?(o(192|u>>>6),o(128|63&u)):u>55295&&u<57344?(o(240|(u=65536+(1047552&u)|1023&t.charCodeAt(++s))>>>18),o(128|u>>>12&63),o(128|u>>>6&63),o(128|63&u)):(o(224|u>>>12),o(128|u>>>6&63),o(128|63&u))}return Vt(i,0,n)}(JSON.stringify(t))))}function me(t,e){return t.type===l.Custom&&t.data.tag===e}function pe(t){return me(t,"sessionIdle")}function ge(t){return me(t,"$session_ending")}function Ie(t){return me(t,"$session_starting")}function ye(t,e){if(void 0===e&&(e=6606028.8),t.size>=e&&t.data.length>1){var r=Math.floor(t.data.length/2),i=t.data.slice(0,r),n=t.data.slice(r);return[ye({size:Ct(i),data:i,sessionId:t.sessionId,windowId:t.windowId}),ye({size:Ct(n),data:n,sessionId:t.sessionId,windowId:t.windowId})].flatMap((t=>t))}return[t]}class be{get sessionId(){return this.H}get j(){if(!this._instance.sessionManager)throw new Error(le+" must be started with a valid sessionManager.");return this._instance.sessionManager}get U(){return this._instance.config.session_recording.session_idle_threshold_ms||3e5}get P(){var t=this._instance.get_property(G);return k(t)?t:b(t)?t===this.sessionId:null}get q(){var t,e=null==(t=this.$)?void 0:t.sampleRate;return S(e)?e:null}get tt(){var t,e=null==(t=this.$)?void 0:t.minimumDurationMilliseconds;return S(e)?e:null}constructor(t){this.et="/s/",this._forceAllowLocalhostNetworkCapture=!1,this.rt=void 0,this.it=Date.now(),this.nt=[],this.ot="unknown",this.st=new vt,this.ut=[],this.lt=void 0,this.dt=void 0,this.ct=It,this.ht=void 0,this.vt=void 0,this.ft=void 0,this.gt=void 0,this.It=(t,e,r)=>{var i;if(r&&(t!==this.H||e!==this.yt)){var n,o=!r.noSessionId&&(r.activityTimeout||r.sessionPastMaximumLength),s=this.H,a=this.yt;if(o)this.bt("$session_ending",{currentSessionId:s,currentWindowId:a,nextSessionId:t,nextWindowId:e,changeReason:r,lastActivityTimestamp:this.it,flushed_size:null==(n=this.Ct)?void 0:n.currentTrackedSize});this.Ct&&this.Ct.reset(),null==(i=this._instance.persistence)||i.unregister(V),this.bt("$session_id_change",{sessionId:t,windowId:e,changeReason:r}),this.wt(),o&&this.bt("$session_starting",{previousSessionId:s,previousWindowId:a,nextSessionId:t,nextWindowId:e,changeReason:r,lastActivityTimestamp:this.it}),S(this.q)&&w(this.ft)&&this.St(t)}},this.kt=()=>{var t;return(null==(t=this._instance.persistence)?void 0:t.props[L])===this.H},this.At=()=>{var t,e;if(0===this.Nt.data.length)return null;var r=null==(t=this.Nt.data[0])?void 0:t.timestamp,i=null==(e=this.Nt.data[this.Nt.data.length-1])?void 0:e.timestamp;return S(r)&&S(i)?i-r:null},this.Rt=()=>{var t,e,r=this.tt;if(!S(r))return!1;if(!(null!==(t=null==(e=this._instance.config.session_recording)?void 0:e.strictMinimumDuration)&&void 0!==t&&t)){var i=this.Tt;return S(i)&&i>=0&&i<r}if(this.kt())return!1;var n,o=this.At();return!!C(o)||(!(o>=r)||(null==(n=this._instance.persistence)||n.register({[L]:this.H}),!1))},this._t=()=>{this.Mt()},this.Ft=()=>{this.bt("browser offline",{})},this.Bt=()=>{this.bt("browser online",{})},this.Ot=()=>{if(null!=n&&n.visibilityState){var t="window "+n.visibilityState;this.bt(t,{})}},this._instance=t;var{sessionId:e,windowId:r}=this.j.checkAndGetSessionAndWindowId();this.H=e,this.yt=r,this.xt=new pt(this._instance),this.Zt=new mt(this._instance),this.Yt=new gt(this._instance),this.Nt=this.Et(),this.U>=this.j.sessionTimeoutMs&&de.warn("session_idle_threshold_ms ("+this.U+") is greater than the session timeout ("+this.j.sessionTimeoutMs+"). Session will never be detected as idle"),this.Ct=new ae(this._instance)}get Gt(){var t,e,r,i,n,o,s,a=null==(t=this.$)?void 0:t.masking,u={maskAllInputs:null==(e=this._instance.config.session_recording)?void 0:e.maskAllInputs,maskTextSelector:null==(r=this._instance.config.session_recording)?void 0:r.maskTextSelector,blockSelector:null==(i=this._instance.config.session_recording)?void 0:i.blockSelector},l=null!==(n=null==u?void 0:u.maskAllInputs)&&void 0!==n?n:null==a?void 0:a.maskAllInputs,d=null!==(o=null==u?void 0:u.maskTextSelector)&&void 0!==o?o:null==a?void 0:a.maskTextSelector,c=null!==(s=null==u?void 0:u.blockSelector)&&void 0!==s?s:null==a?void 0:a.blockSelector;return y(l)&&y(d)&&y(c)?void 0:{maskAllInputs:null==l||l,maskTextSelector:d,blockSelector:c}}get Lt(){var t,e,r,i,n,o,s,a=this._instance.config.session_recording.captureCanvas,u=null==(t=this.$)?void 0:t.canvasRecording,l=null!==(e=null!==(r=null==a?void 0:a.recordCanvas)&&void 0!==r?r:null==u?void 0:u.enabled)&&void 0!==e&&e,d=null!==(i=null!==(n=null==a?void 0:a.canvasFps)&&void 0!==n?n:null==u?void 0:u.fps)&&void 0!==i?i:4,c=null!==(o=null!==(s=null==a?void 0:a.canvasQuality)&&void 0!==s?s:null==u?void 0:u.quality)&&void 0!==o?o:.4;if("string"==typeof c){var h=parseFloat(c);c=isNaN(h)?.4:h}return{enabled:l,fps:N(d,0,12,F("canvas recording fps"),4),quality:N(c,0,1,F("canvas recording quality"),.4)}}get Wt(){var t,e=!(null==(t=this.$)||!t.consoleLogRecordingEnabled),r=this._instance.config.enable_recording_console_log;return null!=r?r:e}get Dt(){var t,e,r,i=null==(t=this.$)?void 0:t.networkPayloadCapture,n={recordHeaders:null==(e=this._instance.config.session_recording)?void 0:e.recordHeaders,recordBody:null==(r=this._instance.config.session_recording)?void 0:r.recordBody},o=(null==n?void 0:n.recordHeaders)||(null==i?void 0:i.recordHeaders),s=(null==n?void 0:n.recordBody)||(null==i?void 0:i.recordBody),a=I(this._instance.config.capture_performance)?this._instance.config.capture_performance.network_timing:this._instance.config.capture_performance,u=!!(k(a)?a:null==i?void 0:i.capturePerformance);return o||s||u?{recordHeaders:o,recordBody:s,recordPerformance:u}:void 0}Vt(){var t,e,r=[],i=null==(t=o.__PosthogExtensions__)||null==(t=t.rrwebPlugins)?void 0:t.getRecordConsolePlugin;i&&this.Wt&&r.push(i());var n=null==(e=o.__PosthogExtensions__)||null==(e=e.rrwebPlugins)?void 0:e.getRecordNetworkPlugin;this.Dt&&g(n)&&(!Z.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?r.push(n(tt(this._instance.config,this.Dt))):de.info("NetworkCapture not started because we are on localhost."));return r}Xt(t){var e=this._instance.config.session_recording;if(e.maskCapturedNetworkRequestFn){var r,i=e.maskCapturedNetworkRequestFn({name:t});return null!==(r=null==i?void 0:i.name)&&void 0!==r?r:null==i?void 0:i.url}if(e.maskNetworkRequestFn){var n=e.maskNetworkRequestFn({url:t});return null==n?void 0:n.url}return t}zt(t){try{return t.rrwebMethod(),!0}catch(e){return this.nt.length<10?this.nt.push({enqueuedAt:t.enqueuedAt||Date.now(),attempt:t.attempt+1,rrwebMethod:t.rrwebMethod}):de.warn("could not emit queued rrweb event.",e,t),!1}}bt(t,e){return this.zt(he((()=>ve().addCustomEvent(t,e))))}Jt(){try{if(this._instance.config.capture_pageview||!t)return;var e=new URL(t.location.href),r=e.origin+e.pathname+e.search,i=this.Xt(r);this.Kt!==i&&(this.Kt=i,this.bt("$url_changed",{href:i}))}catch(t){}}Ht(){if(this.nt.length){var t=[...this.nt];this.nt=[],t.forEach((t=>{Date.now()-t.enqueuedAt<=2e3&&this.zt(t)}))}}jt(){return this.zt(he((()=>ve().takeFullSnapshot())))}get Ut(){var t,e;return this.st.triggerStatus(this.sessionId)!==ut||["sampled","active"].includes(this.status)?null!==(t=null==(e=this._instance.config.session_recording)?void 0:e.full_snapshot_interval_millis)&&void 0!==t?t:ue:6e4}Pt(){if(this.qt&&clearInterval(this.qt),!0!==this.ot){var t=this.Ut;t&&(this.qt=setInterval((()=>{this.jt()}),t))}}Qt(){this.Zt.urlBlocked||(this.Zt.urlBlocked=!0,clearInterval(this.qt),de.info("recording paused due to URL blocker"),this.bt("recording paused",{reason:"url blocker"}))}$t(){this.Zt.urlBlocked&&(this.Zt.urlBlocked=!1,this.jt(),this.Pt(),this.bt("recording resumed",{reason:"left blocked url"}),de.info("recording resumed"))}te(t){var e;this.st.triggerStatus(this.sessionId)===ut&&(null==(e=this._instance)||null==(e=e.persistence)||e.register({["url"===t?W:D]:this.H}),this.Mt(),this.ee(t+"_trigger_matched"))}get isStarted(){return!!this.rt}get $(){var t=this._instance.get_property("$session_recording_remote_config");if(t)return I(t)?t:JSON.parse(t)}re(t,e){var r;this._instance.get_property(t)&&(e(),null==(r=this._instance.persistence)||r.unregister(t))}start(e){var r,i,n=this.$;if(n){var{sessionId:o,windowId:s}=this.j.checkAndGetSessionAndWindowId();this.H=o,this.yt=s,null==(r=this._instance.persistence)||r.unregister(V),null!=n&&n.endpoint&&(this.et=null==n?void 0:n.endpoint),"any"===(null==n?void 0:n.triggerMatchType)?(this.ct=yt,this.st=new ct([this.Yt,this.Zt])):(this.ct=bt,this.st=new ht([this.Yt,this.Zt])),this._instance.register_for_session({$sdk_debug_replay_remote_trigger_matching_config:null==n?void 0:n.triggerMatchType}),this.Zt.onConfig(n),this.Yt.onConfig(n),null==(i=this.dt)||i.call(this),this.ie(),this.xt.onConfig(n,((t,e)=>{this.ee("linked_flag_matched",{flag:t,variant:e})})),this.re("$replay_override_sampling",(()=>{this.overrideSampling()})),this.re("$replay_override_linked_flag",(()=>{this.overrideLinkedFlag()})),this.re("$replay_override_event_trigger",(()=>{this.overrideTrigger("event")})),this.re("$replay_override_url_trigger",(()=>{this.overrideTrigger("url")})),this.St(this.sessionId),this.ne(),x(t,"beforeunload",this._t),x(t,"offline",this.Ft),x(t,"online",this.Bt),x(t,"visibilitychange",this.Ot),this.ht||(this.ht=this.j.onSessionId(this.It)),this.vt||(this.vt=this.j.on("forcedIdleReset",(()=>{this.wt(),this.ot="unknown",this.stop(),this.gt=this.j.onSessionId(((t,e,r)=>{var i;null==(i=this.gt)||i.call(this),this.gt=void 0,this.It(t,e,r)}))}))),w(this.lt)&&(this.lt=this._instance.on("eventCaptured",(t=>{try{if("$pageview"===t.event){var e=null!=t&&t.properties.$current_url?this.Xt(null==t?void 0:t.properties.$current_url):"";if(!e)return;this.bt("$pageview",{href:e})}}catch(t){de.error("Could not add $pageview to rrweb session",t)}}))),this.status===it&&this.ee(e||"recording_initialized")}else de.info("remote config must be stored in persistence before recording can start")}stop(){var e,r,i,n,o,s,a,u;null==t||t.removeEventListener("beforeunload",this._t),null==t||t.removeEventListener("offline",this.Ft),null==t||t.removeEventListener("online",this.Bt),null==t||t.removeEventListener("visibilitychange",this.Ot),this.Mt(),this.Et(),clearInterval(this.qt),this.oe(),null==(e=this.lt)||e.call(this),this.lt=void 0,null==(r=this.dt)||r.call(this),this.dt=void 0,null==(i=this.ht)||i.call(this),this.ht=void 0,null==(n=this.vt)||n.call(this),this.vt=void 0,null==(o=this.ft)||o.call(this),this.ft=void 0,null==(s=this.gt)||s.call(this),this.gt=void 0,this.Yt.stop(),this.Zt.stop(),this.xt.stop(),null==(a=this.se)||a.stop(),this.nt=[],null==(u=this.rt)||u.call(this),this.rt=void 0,de.info("stopped")}onRRwebEmit(t){var e,r,i,n,o;if(this.Ht(),t&&I(t)){if(t.type===l.Meta){var s=this.Xt(t.data.href);if(this.Kt=s,!s)return;t.data.href=s}else this.Jt();if(this.Zt.checkUrlTriggerConditions((()=>this.Qt()),(()=>this.$t()),(t=>this.te(t)),this.sessionId),!this.Zt.urlBlocked||(a=t).type===l.Custom&&"recording paused"===a.data.tag){var a,c,h;if(t.type===l.FullSnapshot)this.Pt(),null==(c=this.se)||c.reset(),null==(h=this._instance.persistence)||h.register_once({[V]:t.timestamp},void 0);t.type===l.FullSnapshot&&this.st.triggerStatus(this.sessionId)===ut&&this.ae();var v=this.se?this.se.throttleMutations(t):t;if(v){var f=function(t){var e=t;if(e&&I(e)&&6===e.type&&I(e.data)&&"rrweb/console@1"===e.data.plugin){e.data.payload.payload.length>10&&(e.data.payload.payload=e.data.payload.payload.slice(0,10),e.data.payload.payload.push("...[truncated]"));for(var r=[],i=0;i<e.data.payload.payload.length;i++)e.data.payload.payload[i]&&e.data.payload.payload[i].length>2e3?r.push(e.data.payload.payload[i].slice(0,2e3)+"...[truncated]"):r.push(e.data.payload.payload[i]);return e.data.payload.payload=r,t}return t}(v),m=function(t){return ge(t)?t.data.payload:null}(f),p=function(t){return Ie(t)?t.data.payload:null}(f);if(m||p){var g=null!=m?m:p;null!=g&&g.lastActivityTimestamp&&(f.timestamp=g.lastActivityTimestamp)}else this.ue(f);t.type===l.FullSnapshot&&(this.ut.push([this.H,t.timestamp]),this.ut.length>6&&(this.ut=this.ut.slice(-6)));var y=null!==(e=null!==(r=null==m?void 0:m.currentSessionId)&&void 0!==r?r:null==p?void 0:p.nextSessionId)&&void 0!==e?e:this.H,b=null!==(i=null!==(n=null==m?void 0:m.currentWindowId)&&void 0!==n?n:null==p?void 0:p.nextWindowId)&&void 0!==i?i:this.yt;if(!0!==this.ot||function(t){return pe(t)||ge(t)||Ie(t)}(f)){if(pe(f)){var C=f.data.payload;if(C){var w=C.lastActivityTimestamp,S=C.threshold;f.timestamp=w+S}}var k=null===(o=this._instance.config.session_recording.compress_events)||void 0===o||o?function(t){try{if(t.type===l.FullSnapshot)return u({},t,{data:fe(t.data),cv:"2024-10"});if(t.type===l.IncrementalSnapshot&&t.data.source===d.Mutation)return u({},t,{cv:"2024-10",data:u({},t.data,{texts:fe(t.data.texts),attributes:fe(t.data.attributes),removes:fe(t.data.removes),adds:fe(t.data.adds)})});if(t.type===l.IncrementalSnapshot&&t.data.source===d.StyleSheetRule)return u({},t,{cv:"2024-10",data:u({},t.data,{adds:t.data.adds?fe(t.data.adds):void 0,removes:t.data.removes?fe(t.data.removes):void 0})})}catch(t){de.error("could not compress event - will use uncompressed event",t)}return t}(f):f,A={$snapshot_bytes:Ct(k),$snapshot_data:k,$session_id:y,$window_id:b};this.status!==et?this.le(A):this.Et()}}}}}get status(){return this.ct({receivedFlags:!0,isRecordingEnabled:!0,isSampled:this.P,urlTriggerMatching:this.Zt,eventTriggerMatching:this.Yt,linkedFlagMatching:this.xt,sessionId:this.sessionId})}log(t,e){var r;void 0===e&&(e="log"),null==(r=this._instance.sessionRecording)||r.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:e,trace:[],payload:[JSON.stringify(t)]}},timestamp:Date.now()})}overrideLinkedFlag(){this.xt.linkedFlagSeen=!0,this.jt(),this.ee("linked_flag_overridden")}overrideSampling(){var t;null==(t=this._instance.persistence)||t.register({[G]:this.sessionId}),this.jt(),this.ee("sampling_overridden")}overrideTrigger(t){this.te(t)}oe(){this.de&&(clearTimeout(this.de),this.de=void 0)}Mt(){this.oe();var t=this.Rt();if(this.status===nt||this.status===ot||this.status===et||t)return this.de=setTimeout((()=>{this.Mt()}),2e3),this.Nt;this.Nt.data.length>0&&ye(this.Nt).forEach((t=>{var e;null==(e=this.Ct)||e.trackSize(t.size),this.ce({$snapshot_bytes:t.size,$snapshot_data:t.data,$session_id:t.sessionId,$window_id:t.windowId,$lib:"web",$lib_version:T.LIB_VERSION})}));return this.Et()}le(t){var e,r=2+((null==(e=this.Nt)?void 0:e.data.length)||0),i=t.$session_id;!this.ot&&(this.Nt.size+t.$snapshot_bytes+r>943718.4||this.Nt.sessionId!==i)&&(this.Nt=this.Mt(),this.Nt.sessionId=i,this.Nt.windowId=t.$window_id),this.Nt.size+=t.$snapshot_bytes,this.Nt.data.push(t.$snapshot_data),this.de||this.ot||(this.de=setTimeout((()=>{this.Mt()}),2e3))}ce(t){this._instance.capture("$snapshot",t,{_url:this._instance.requestRouter.endpointFor("api",this.et),_noTruncate:!0,_batchKey:"recordings",skip_client_rate_limiting:!0})}get Tt(){var t,e,r=null==(t=this.Nt)?void 0:t.data[(null==(e=this.Nt)?void 0:e.data.length)-1],{sessionStartTimestamp:i}=this.j.checkAndGetSessionAndWindowId(!0);return r?r.timestamp-i:null}ae(){if(!this.Nt||0===this.Nt.data.length)return this.Et();for(var t=-1,e=this.Nt.data.length-1;e>=0;e--)if(this.Nt.data[e].type===l.Meta){t=e;break}return t>=0?(this.Nt.data=this.Nt.data.slice(t),this.Nt.size=this.Nt.data.reduce(((t,e)=>t+Ct(e)),0),this.Nt):this.Et()}Et(){return this.Nt={size:0,data:[],sessionId:this.H,windowId:this.yt},this.Nt}ee(t,e){this._instance.register_for_session({$session_recording_start_reason:t}),de.info(t.replace("_"," "),e),-1===["recording_initialized","session_id_changed"].indexOf(t)&&this.bt(t,e)}he(t){var e;return 3===t.type&&-1!==ce.indexOf(null==(e=t.data)?void 0:e.source)}ue(t){var e=this.he(t);e||this.ot||t.timestamp-this.it>this.U&&(this.ot=!0,clearInterval(this.qt),this.bt("sessionIdle",{eventTimestamp:t.timestamp,lastActivityTimestamp:this.it,threshold:this.U,bufferLength:this.Nt.data.length,bufferSize:this.Nt.size}),this.Mt());var r=!1;if(e&&(this.it=t.timestamp,this.ot)){var i="unknown"===this.ot;this.ot=!1,i||(this.bt("sessionNoLongerIdle",{reason:"user activity",type:t.type}),r=!0)}if(!this.ot){var{windowId:n,sessionId:o}=this.j.checkAndGetSessionAndWindowId(!e,t.timestamp),s=this.H!==o,a=this.yt!==n;this.yt=n,this.H=o,s||a?(this.stop(),this.start("session_id_changed")):r&&this.Pt()}}wt(){var t,e,r,i;null==(t=this._instance)||null==(t=t.persistence)||t.unregister(D),null==(e=this._instance)||null==(e=e.persistence)||e.unregister(W),null==(r=this._instance)||null==(r=r.persistence)||r.unregister(G),null==(i=this._instance)||null==(i=i.persistence)||i.unregister(L)}St(t){var e,r=this.H!==t,i=this.q;if(S(i)){var n=this.P,o=r||!k(n),s=o?oe(t,i):n;o&&(s?this.ee(rt):de.warn("Sample rate ("+i+") has determined that this sessionId ("+t+") will not be sent to the server."),this.bt("samplingDecisionMade",{sampleRate:i,isSampled:s})),null==(e=this._instance.persistence)||e.register({[G]:!!s&&t})}else{var a;null==(a=this._instance.persistence)||a.unregister(G)}}ie(){0!==this.Yt.O.length&&w(this.dt)&&(this.dt=this._instance.on("eventCaptured",(t=>{try{this.Yt.O.includes(t.event)&&this.te("event")}catch(t){de.error("Could not activate event trigger",t)}})))}get sdkDebugProperties(){var t,{sessionStartTimestamp:e}=this.j.checkAndGetSessionAndWindowId(!0);return{$recording_status:this.status,$sdk_debug_replay_internal_buffer_length:this.Nt.data.length,$sdk_debug_replay_internal_buffer_size:this.Nt.size,$sdk_debug_current_session_duration:this.Tt,$sdk_debug_session_start:e,$sdk_debug_replay_flushed_size:null==(t=this.Ct)?void 0:t.currentTrackedSize,$sdk_debug_replay_full_snapshots:this.ut}}ne(){var t;if(!this.rt){var e,r,i,n={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{password:!0},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},o=this._instance.config.session_recording;for(var[s,a]of Object.entries(o||{}))s in n&&("maskInputOptions"===s?n.maskInputOptions=u({password:!0},a):n[s]=a);if(this.Lt&&this.Lt.enabled&&(n.recordCanvas=!0,n.sampling={canvas:this.Lt.fps},n.dataURLOptions={type:"image/webp",quality:this.Lt.quality}),this.Gt)n.maskAllInputs=null===(e=this.Gt.maskAllInputs)||void 0===e||e,n.maskTextSelector=null!==(r=this.Gt.maskTextSelector)&&void 0!==r?r:void 0,n.blockSelector=null!==(i=this.Gt.blockSelector)&&void 0!==i?i:void 0;var l=ve();if(l){this.se=null!==(t=this.se)&&void 0!==t?t:new ne(l,{refillRate:this._instance.config.session_recording.__mutationThrottlerRefillRate,bucketSize:this._instance.config.session_recording.__mutationThrottlerBucketSize,onBlockedNode:(t,e)=>{var r="Too many mutations on node '"+t+"'. Rate limiting. This could be due to SVG animations or something similar";de.info(r,{node:e}),this.log(le+" "+r,"warn")}});var d=this.Vt();this.rt=l(u({emit:t=>{this.onRRwebEmit(t)},plugins:d},n)),this.it=Date.now(),this.ot=k(this.ot)?this.ot:"unknown",this.tryAddCustomEvent("$remote_config_received",this.$),this.bt("$session_options",{sessionRecordingOptions:n,activePlugins:d.map((t=>null==t?void 0:t.name))}),this.bt("$posthog_config",{config:this._instance.config})}else de.error("_startRecorder was called but rrwebRecord is not available. This indicates something has gone wrong.")}}tryAddCustomEvent(t,e){return this.bt(t,e)}}var Ce,we=["type"],Se=Object.defineProperty,ke=(t,e,r)=>((t,e,r)=>e in t?Se(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),Ae=Object.defineProperty,Ne=(t,e,r)=>((t,e,r)=>e in t?Ae(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),Re=(t=>(t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment",t))(Re||{}),Te={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},_e={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]};var Me={};function Fe(t){if(Me[t])return Me[t];var e=function(t){var e,r=null==globalThis||null==(e=globalThis.Zone)||null==e.__symbol__?void 0:e.__symbol__(t);return r&&globalThis[r]?globalThis[r]:void 0}(t)||globalThis[t],r=e.prototype,i=t in Te?Te[t]:void 0,n=Boolean(i&&i.every((t=>{var e,i;return Boolean(null==(i=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:i.toString().includes("[native code]"))}))),o=t in _e?_e[t]:void 0,s=Boolean(o&&o.every((t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))})));if(n&&s)return Me[t]=e.prototype,e.prototype;try{var a=document.createElement("iframe");document.body.appendChild(a);var u=a.contentWindow;if(!u)return e.prototype;var l=u[t].prototype;return document.body.removeChild(a),l?Me[t]=l:e.prototype}catch(t){return e.prototype}}var Be={};function Oe(t,e,r){var i,n=t+"."+String(r);if(Be[n])return Be[n].call(e);var o=Fe(t),s=null==(i=Object.getOwnPropertyDescriptor(o,r))?void 0:i.get;return s?(Be[n]=s,s.call(e)):e[r]}var xe={};function Ze(t,e,r){var i=t+"."+String(r);if(xe[i])return xe[i].bind(e);var n=Fe(t)[r];return"function"!=typeof n?e[r]:(xe[i]=n,n.bind(e))}var Ye={childNodes:function(t){return Oe("Node",t,"childNodes")},parentNode:function(t){return Oe("Node",t,"parentNode")},parentElement:function(t){return Oe("Node",t,"parentElement")},textContent:function(t){return Oe("Node",t,"textContent")},contains:function(t,e){return Ze("Node",t,"contains")(e)},getRootNode:function(t){return Ze("Node",t,"getRootNode")()},host:function(t){return t&&"host"in t?Oe("ShadowRoot",t,"host"):null},styleSheets:function(t){return t.styleSheets},shadowRoot:function(t){return t&&"shadowRoot"in t?Oe("Element",t,"shadowRoot"):null},querySelector:function(t,e){return Oe("Element",t,"querySelector")(e)},querySelectorAll:function(t,e){return Oe("Element",t,"querySelectorAll")(e)},mutationObserver:function(){return Fe("MutationObserver").constructor}};function Ee(t){return t.nodeType===t.ELEMENT_NODE}function Ge(t){var e=t&&"host"in t&&"mode"in t&&Ye.host(t)||null;return Boolean(e&&"shadowRoot"in e&&Ye.shadowRoot(e)===t)}function Le(t){return"[object ShadowRoot]"===Object.prototype.toString.call(t)}function We(t){try{var e=t.rules||t.cssRules;if(!e)return null;var r=Array.from(e,(e=>De(e,t.href))).join("");return(i=r).includes(" background-clip: text;")&&!i.includes(" -webkit-background-clip: text;")&&(i=i.replace(/\sbackground-clip:\s*text;/g," -webkit-background-clip: text; background-clip: text;")),i}catch(t){return null}var i}function De(t,e){if(function(t){return"styleSheet"in t}(t)){var r;try{r=We(t.styleSheet)||function(t){var{cssText:e}=t;if(e.split('"').length<3)return e;var r=["@import","url("+JSON.stringify(t.href)+")"];return""===t.layerName?r.push("layer"):t.layerName&&r.push("layer("+t.layerName+")"),t.supportsText&&r.push("supports("+t.supportsText+")"),t.media.length&&r.push(t.media.mediaText),r.join(" ")+";"}(t)}catch(e){r=t.cssText}return t.styleSheet.href?$e(r,t.styleSheet.href):r}var i,n=t.cssText;return function(t){return"selectorText"in t}(t)&&t.selectorText.includes(":")&&(i=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm,n=n.replace(i,"$1\\$2")),e?$e(n,e):n}function Ve(t,e){return Array.from(t.styleSheets).find((t=>t.href===e))}let Xe=class{constructor(){Ne(this,"idNodeMap",new Map),Ne(this,"nodeMetaMap",new WeakMap)}getId(t){var e;if(!t)return-1;var r=null==(e=this.getMeta(t))?void 0:e.id;return null!=r?r:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){var e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){var r=e.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,e)}replace(t,e){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(e,i)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}};function ze(t){var{element:e,maskInputOptions:r,tagName:i,type:n,value:o,maskInputFn:s}=t,a=o||"",u=n&&Je(n);return(r[i.toLowerCase()]||u&&r[u])&&(a=s?s(a,e):"*".repeat(a.length)),a}function Je(t){return t.toLowerCase()}var Ke="__rrweb_original__";function He(t){var e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?Je(e):null}function je(t,e){var r,i;try{i=new URL(t,null!=e?e:window.location.href)}catch(t){return null}var n=i.pathname.match(/\.([0-9a-z]+)(?:$)/i);return null!==(r=null==n?void 0:n[1])&&void 0!==r?r:null}var Ue=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,Pe=/^(?:[a-z+]+:)?\/\//i,qe=/^www\..*/i,Qe=/^(data:)([^,]*),(.*)/i;function $e(t,e){return(t||"").replace(Ue,((t,r,i,n,o,s)=>{var a,u=i||o||s,l=r||n||"";if(!u)return t;if(Pe.test(u)||qe.test(u))return"url("+l+u+l+")";if(Qe.test(u))return"url("+l+u+l+")";if("/"===u[0])return"url("+l+(((a=e).indexOf("//")>-1?a.split("/").slice(0,3).join("/"):a.split("/")[0]).split("?")[0]+u)+l+")";var d=e.split("/"),c=u.split("/");for(var h of(d.pop(),c))"."!==h&&(".."===h?d.pop():d.push(h));return"url("+l+d.join("/")+l+")"}))}var tr,er,rr=1,ir=new RegExp("[^a-z0-9-_:]"),nr=-2;function or(){return rr++}var sr=/^[^ \t\n\r\u000c]+/,ar=/^[, \t\n\r\u000c]+/;var ur=new WeakMap;function lr(t,e){return e&&""!==e.trim()?cr(t,e):e}function dr(t){return Boolean("svg"===t.tagName||t.ownerSVGElement)}function cr(t,e){var r=ur.get(t);if(r||(r=t.createElement("a"),ur.set(t,r)),e){if(e.startsWith("blob:")||e.startsWith("data:"))return e}else e="";return r.setAttribute("href",e),r.href}function hr(t,e,r,i){return i?"src"===r||"href"===r&&("use"!==e||"#"!==i[0])||"xlink:href"===r&&"#"!==i[0]?lr(t,i):"background"!==r||"table"!==e&&"td"!==e&&"th"!==e?"srcset"===r?function(t,e){if(""===e.trim())return e;var r=0;function i(t){var i,n=t.exec(e.substring(r));return n?(i=n[0],r+=i.length,i):""}for(var n=[];i(ar),!(r>=e.length);){var o=i(sr);if(","===o.slice(-1))o=lr(t,o.substring(0,o.length-1)),n.push(o);else{var s="";o=lr(t,o);for(var a=!1;;){var u=e.charAt(r);if(""===u){n.push((o+s).trim());break}if(a)")"===u&&(a=!1);else{if(","===u){r+=1,n.push((o+s).trim());break}"("===u&&(a=!0)}s+=u,r+=1}}}return n.join(", ")}(t,i):"style"===r?$e(i,cr(t)):"object"===e&&"data"===r?lr(t,i):i:lr(t,i):i}function vr(t,e,r){return("video"===t||"audio"===t)&&"autoplay"===e}function fr(t,e,r){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!r&&fr(Ye.parentNode(t),e,r);for(var i=t.classList.length;i--;){var n=t.classList[i];if(e.test(n))return!0}return!!r&&fr(Ye.parentNode(t),e,r)}function mr(t,e,r,i){var n;if(Ee(t)){if(n=t,!Ye.childNodes(n).length)return!1}else{if(null===Ye.parentElement(t))return!1;n=Ye.parentElement(t)}try{if("string"==typeof e){if(i){if(n.closest("."+e))return!0}else if(n.classList.contains(e))return!0}else if(fr(n,e,i))return!0;if(r)if(i){if(n.closest(r))return!0}else if(n.matches(r))return!0}catch(t){}return!1}function pr(t,e){var{doc:r,mirror:i,blockClass:n,blockSelector:o,needsMask:s,inlineStylesheet:a,maskInputOptions:u={},maskTextFn:l,maskInputFn:d,dataURLOptions:c={},inlineImages:h,recordCanvas:v,keepIframeSrcFn:f,newlyAddedElement:m=!1}=e,p=function(t,e){if(!e.hasNode(t))return;var r=e.getId(t);return 1===r?void 0:r}(r,i);switch(t.nodeType){case t.DOCUMENT_NODE:return"CSS1Compat"!==t.compatMode?{type:Re.Document,childNodes:[],compatMode:t.compatMode}:{type:Re.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:Re.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:p};case t.ELEMENT_NODE:return function(t,e){for(var r,{doc:i,blockClass:n,blockSelector:o,inlineStylesheet:s,maskInputOptions:a={},maskInputFn:u,dataURLOptions:l={},inlineImages:d,recordCanvas:c,keepIframeSrcFn:h,newlyAddedElement:v=!1,rootId:f}=e,m=function(t,e,r){try{if("string"==typeof e){if(t.classList.contains(e))return!0}else for(var i=t.classList.length;i--;){var n=t.classList[i];if(e.test(n))return!0}if(r)return t.matches(r)}catch(t){}return!1}(t,n,o),p=function(t){if(t instanceof HTMLFormElement)return"form";var e=Je(t.tagName);return ir.test(e)?"div":e}(t),g={},I=t.attributes.length,y=0;y<I;y++){var b=t.attributes[y];vr(p,b.name,b.value)||(g[b.name]=hr(i,p,Je(b.name),b.value))}if("link"===p&&s){var C=function(t){return null==t?void 0:t.href}(t);if(C){var w=Ve(i,C);if(!w&&C.includes(".css"))w=Ve(i,window.location.origin+"/"+C.replace(window.location.href,""));var S=null;w&&(S=We(w)),S&&(delete g.rel,delete g.href,g._cssText=S)}}if("style"===p&&t.sheet&&!(t.innerText||Ye.textContent(t)||"").trim().length){var k=We(t.sheet);k&&(g._cssText=k)}if("input"===p||"textarea"===p||"select"===p){var A=t.value,N=t.checked;"radio"!==g.type&&"checkbox"!==g.type&&"submit"!==g.type&&"button"!==g.type&&A?g.value=ze({element:t,type:He(t),tagName:p,value:A,maskInputOptions:a,maskInputFn:u}):N&&(g.checked=N)}"option"===p&&(t.selected&&!a.select?g.selected=!0:delete g.selected);if("dialog"===p&&t.open)try{g.rr_open_mode=t.matches("dialog:modal")?"modal":"non-modal"}catch(t){g.rr_open_mode="modal",g.ph_rr_could_not_detect_modal=!0}if("canvas"===p&&c)if("2d"===t.__context)(function(t){var e=t.getContext("2d");if(!e)return!0;for(var r=0;r<t.width;r+=50)for(var i=0;i<t.height;i+=50){var n=e.getImageData,o=Ke in n?n[Ke]:n;if(new Uint32Array(o.call(e,r,i,Math.min(50,t.width-r),Math.min(50,t.height-i)).data.buffer).some((t=>0!==t)))return!1}return!0})(t)||(g.rr_dataURL=t.toDataURL(l.type,l.quality));else if(!("__context"in t)){var R=t.toDataURL(l.type,l.quality),T=i.createElement("canvas");T.width=t.width,T.height=t.height,R!==T.toDataURL(l.type,l.quality)&&(g.rr_dataURL=R)}if("img"===p&&d){tr||(tr=i.createElement("canvas"),er=tr.getContext("2d"));var _=t,M=_.currentSrc||_.getAttribute("src")||"<unknown-src>",F=_.crossOrigin,B=()=>{_.removeEventListener("load",B);try{tr.width=_.naturalWidth,tr.height=_.naturalHeight,er.drawImage(_,0,0),g.rr_dataURL=tr.toDataURL(l.type,l.quality)}catch(t){if("anonymous"!==_.crossOrigin)return _.crossOrigin="anonymous",void(_.complete&&0!==_.naturalWidth?B():_.addEventListener("load",B));console.warn("Cannot inline img src="+M+"! Error: "+t)}"anonymous"===_.crossOrigin&&(F?g.crossOrigin=F:_.removeAttribute("crossorigin"))};_.complete&&0!==_.naturalWidth?B():_.addEventListener("load",B)}if("audio"===p||"video"===p){var O=g;O.rr_mediaState=t.paused?"paused":"played",O.rr_mediaCurrentTime=t.currentTime,O.rr_mediaPlaybackRate=t.playbackRate,O.rr_mediaMuted=t.muted,O.rr_mediaLoop=t.loop,O.rr_mediaVolume=t.volume}v||(t.scrollLeft&&(g.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(g.rr_scrollTop=t.scrollTop));if(m){var{width:x,height:Z}=t.getBoundingClientRect();g={class:g.class,rr_width:x+"px",rr_height:Z+"px"}}"iframe"!==p||h(g.src)||(t.contentDocument||(g.rr_src=g.src),delete g.src);try{customElements.get(p)&&(r=!0)}catch(t){}return{type:Re.Element,tagName:p,attributes:g,childNodes:[],isSVG:dr(t)||void 0,needBlock:m,rootId:f,isCustom:r}}(t,{doc:r,blockClass:n,blockSelector:o,inlineStylesheet:a,maskInputOptions:u,maskInputFn:d,dataURLOptions:c,inlineImages:h,recordCanvas:v,keepIframeSrcFn:f,newlyAddedElement:m,rootId:p});case t.TEXT_NODE:return function(t,e){var r,{needsMask:i,maskTextFn:n,rootId:o}=e,s=Ye.parentNode(t),a=s&&s.tagName,u=Ye.textContent(t),l="STYLE"===a||void 0,d="SCRIPT"===a||void 0;if(l&&u){try{t.nextSibling||t.previousSibling||(null==(r=s.sheet)?void 0:r.cssRules)&&(u=We(s.sheet))}catch(e){console.warn("Cannot get CSS styles from text's parentNode. Error: "+e,t)}u=$e(u,cr(e.doc))}d&&(u="SCRIPT_PLACEHOLDER");!l&&!d&&u&&i&&(u=n?n(u,Ye.parentElement(t)):u.replace(/[\S]/g,"*"));return{type:Re.Text,textContent:u||"",isStyle:l,rootId:o}}(t,{doc:r,needsMask:s,maskTextFn:l,rootId:p});case t.CDATA_SECTION_NODE:return{type:Re.CDATA,textContent:"",rootId:p};case t.COMMENT_NODE:return{type:Re.Comment,textContent:Ye.textContent(t)||"",rootId:p};default:return!1}}function gr(t){return null==t?"":t.toLowerCase()}function Ir(t,e){var{doc:r,mirror:i,blockClass:n,blockSelector:o,maskTextClass:s,maskTextSelector:a,skipChild:u=!1,inlineStylesheet:l=!0,maskInputOptions:d={},maskTextFn:c,maskInputFn:h,slimDOMOptions:v,dataURLOptions:f={},inlineImages:m=!1,recordCanvas:p=!1,onSerialize:g,onIframeLoad:I,iframeLoadTimeout:y=5e3,onStylesheetLoad:b,stylesheetLoadTimeout:C=5e3,keepIframeSrcFn:w=(()=>!1),newlyAddedElement:S=!1}=e,{needsMask:k}=e,{preserveWhiteSpace:A=!0}=e;k||(k=mr(t,s,a,void 0===k));var N,R=pr(t,{doc:r,mirror:i,blockClass:n,blockSelector:o,needsMask:k,inlineStylesheet:l,maskInputOptions:d,maskTextFn:c,maskInputFn:h,dataURLOptions:f,inlineImages:m,recordCanvas:p,keepIframeSrcFn:w,newlyAddedElement:S});if(!R)return console.warn(t,"not serialized"),null;N=i.hasNode(t)?i.getId(t):!function(t,e){if(e.comment&&t.type===Re.Comment)return!0;if(t.type===Re.Element){if(e.script&&("script"===t.tagName||"link"===t.tagName&&("preload"===t.attributes.rel||"modulepreload"===t.attributes.rel)&&"script"===t.attributes.as||"link"===t.tagName&&"prefetch"===t.attributes.rel&&"string"==typeof t.attributes.href&&"js"===je(t.attributes.href)))return!0;if(e.headFavicon&&("link"===t.tagName&&"shortcut icon"===t.attributes.rel||"meta"===t.tagName&&(gr(t.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===gr(t.attributes.name)||"icon"===gr(t.attributes.rel)||"apple-touch-icon"===gr(t.attributes.rel)||"shortcut icon"===gr(t.attributes.rel))))return!0;if("meta"===t.tagName){if(e.headMetaDescKeywords&&gr(t.attributes.name).match(/^description|keywords$/))return!0;if(e.headMetaSocial&&(gr(t.attributes.property).match(/^(og|twitter|fb):/)||gr(t.attributes.name).match(/^(og|twitter):/)||"pinterest"===gr(t.attributes.name)))return!0;if(e.headMetaRobots&&("robots"===gr(t.attributes.name)||"googlebot"===gr(t.attributes.name)||"bingbot"===gr(t.attributes.name)))return!0;if(e.headMetaHttpEquiv&&void 0!==t.attributes["http-equiv"])return!0;if(e.headMetaAuthorship&&("author"===gr(t.attributes.name)||"generator"===gr(t.attributes.name)||"framework"===gr(t.attributes.name)||"publisher"===gr(t.attributes.name)||"progid"===gr(t.attributes.name)||gr(t.attributes.property).match(/^article:/)||gr(t.attributes.property).match(/^product:/)))return!0;if(e.headMetaVerification&&("google-site-verification"===gr(t.attributes.name)||"yandex-verification"===gr(t.attributes.name)||"csrf-token"===gr(t.attributes.name)||"p:domain_verify"===gr(t.attributes.name)||"verify-v1"===gr(t.attributes.name)||"verification"===gr(t.attributes.name)||"shopify-checkout-api-token"===gr(t.attributes.name)))return!0}}return!1}(R,v)&&(A||R.type!==Re.Text||R.isStyle||R.textContent.replace(/^\s+|\s+$/gm,"").length)?or():nr;var T=Object.assign(R,{id:N});if(i.add(t,T),N===nr)return null;g&&g(t);var _=!u;if(T.type===Re.Element){_=_&&!T.needBlock,delete T.needBlock;var M=Ye.shadowRoot(t);M&&Le(M)&&(T.isShadowHost=!0)}if((T.type===Re.Document||T.type===Re.Element)&&_){v.headWhitespace&&T.type===Re.Element&&"head"===T.tagName&&(A=!1);var F={doc:r,mirror:i,blockClass:n,blockSelector:o,needsMask:k,maskTextClass:s,maskTextSelector:a,skipChild:u,inlineStylesheet:l,maskInputOptions:d,maskTextFn:c,maskInputFn:h,slimDOMOptions:v,dataURLOptions:f,inlineImages:m,recordCanvas:p,preserveWhiteSpace:A,onSerialize:g,onIframeLoad:I,iframeLoadTimeout:y,onStylesheetLoad:b,stylesheetLoadTimeout:C,keepIframeSrcFn:w};if(T.type===Re.Element&&"textarea"===T.tagName&&void 0!==T.attributes.value);else for(var B of Array.from(Ye.childNodes(t))){var O=Ir(B,F);O&&T.childNodes.push(O)}var x=null;if(Ee(t)&&(x=Ye.shadowRoot(t)))for(var Z of Array.from(Ye.childNodes(x))){var Y=Ir(Z,F);Y&&(Le(x)&&(Y.isShadow=!0),T.childNodes.push(Y))}}var E=Ye.parentNode(t);return E&&Ge(E)&&Le(E)&&(T.isShadow=!0),T.type===Re.Element&&"iframe"===T.tagName&&function(t,e,r){var i=t.contentWindow;if(i){var n,o=!1;try{n=i.document.readyState}catch(t){return}if("complete"===n){var s="about:blank";if(i.location.href!==s||t.src===s||""===t.src)return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}else{var a=setTimeout((()=>{o||(e(),o=!0)}),r);t.addEventListener("load",(()=>{clearTimeout(a),o=!0,e()}))}}}(t,(()=>{var e=t.contentDocument;if(e&&I){var r=Ir(e,{doc:e,mirror:i,blockClass:n,blockSelector:o,needsMask:k,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:l,maskInputOptions:d,maskTextFn:c,maskInputFn:h,slimDOMOptions:v,dataURLOptions:f,inlineImages:m,recordCanvas:p,preserveWhiteSpace:A,onSerialize:g,onIframeLoad:I,iframeLoadTimeout:y,onStylesheetLoad:b,stylesheetLoadTimeout:C,keepIframeSrcFn:w});r&&I(t,r)}}),y),T.type===Re.Element&&"link"===T.tagName&&"string"==typeof T.attributes.rel&&("stylesheet"===T.attributes.rel||"preload"===T.attributes.rel&&"string"==typeof T.attributes.href&&"css"===je(T.attributes.href))&&function(t,e,r){var i,n=!1;try{i=t.sheet}catch(t){return}if(!i){var o=setTimeout((()=>{n||(e(),n=!0)}),r);t.addEventListener("load",(()=>{clearTimeout(o),n=!0,e()}))}}(t,(()=>{if(b){var e=Ir(t,{doc:r,mirror:i,blockClass:n,blockSelector:o,needsMask:k,maskTextClass:s,maskTextSelector:a,skipChild:!1,inlineStylesheet:l,maskInputOptions:d,maskTextFn:c,maskInputFn:h,slimDOMOptions:v,dataURLOptions:f,inlineImages:m,recordCanvas:p,preserveWhiteSpace:A,onSerialize:g,onIframeLoad:I,iframeLoadTimeout:y,onStylesheetLoad:b,stylesheetLoadTimeout:C,keepIframeSrcFn:w});e&&b(t,e)}}),C),T}let yr=class t{constructor(){__publicField2(this,"parentElement",null),__publicField2(this,"parentNode",null),__publicField2(this,"ownerDocument"),__publicField2(this,"firstChild",null),__publicField2(this,"lastChild",null),__publicField2(this,"previousSibling",null),__publicField2(this,"nextSibling",null),__publicField2(this,"ELEMENT_NODE",1),__publicField2(this,"TEXT_NODE",3),__publicField2(this,"nodeType"),__publicField2(this,"nodeName"),__publicField2(this,"RRNodeType")}get childNodes(){for(var t=[],e=this.firstChild;e;)t.push(e),e=e.nextSibling;return t}contains(e){if(!(e instanceof t))return!1;if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,e){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}};var br={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Cr={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]};var wr={};function Sr(t){if(wr[t])return wr[t];var e=function(t){var e,r=null==globalThis||null==(e=globalThis.Zone)||null==e.__symbol__?void 0:e.__symbol__(t);return r&&globalThis[r]?globalThis[r]:void 0}(t)||globalThis[t],r=e.prototype,i=t in br?br[t]:void 0,n=Boolean(i&&i.every((t=>{var e,i;return Boolean(null==(i=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:i.toString().includes("[native code]"))}))),o=t in Cr?Cr[t]:void 0,s=Boolean(o&&o.every((t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))})));if(n&&s)return wr[t]=e.prototype,e.prototype;try{var a=document.createElement("iframe");document.body.appendChild(a);var u=a.contentWindow;if(!u)return e.prototype;var l=u[t].prototype;return document.body.removeChild(a),l?wr[t]=l:r}catch(t){return r}}var kr={};function Ar(t,e,r){var i,n=t+"."+String(r);if(kr[n])return kr[n].call(e);var o=Sr(t),s=null==(i=Object.getOwnPropertyDescriptor(o,r))?void 0:i.get;return s?(kr[n]=s,s.call(e)):e[r]}var Nr={};function Rr(t,e,r){var i=t+"."+String(r);if(Nr[i])return Nr[i].bind(e);var n=Sr(t)[r];return"function"!=typeof n?e[r]:(Nr[i]=n,n.bind(e))}function Tr(){return Sr("MutationObserver").constructor}var _r={childNodes:function(t){return Ar("Node",t,"childNodes")},parentNode:function(t){return Ar("Node",t,"parentNode")},parentElement:function(t){return Ar("Node",t,"parentElement")},textContent:function(t){return Ar("Node",t,"textContent")},contains:function(t,e){return Rr("Node",t,"contains")(e)},getRootNode:function(t){return Rr("Node",t,"getRootNode")()},host:function(t){return t&&"host"in t?Ar("ShadowRoot",t,"host"):null},styleSheets:function(t){return t.styleSheets},shadowRoot:function(t){return t&&"shadowRoot"in t?Ar("Element",t,"shadowRoot"):null},querySelector:function(t,e){return Ar("Element",t,"querySelector")(e)},querySelectorAll:function(t,e){return Ar("Element",t,"querySelectorAll")(e)},mutationObserver:Tr};function Mr(t,e,r){void 0===r&&(r=document);var i={capture:!0,passive:!0};return r.addEventListener(t,e,i),()=>r.removeEventListener(t,e,i)}var Fr="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",Br={map:{},getId:()=>(console.error(Fr),-1),getNode:()=>(console.error(Fr),null),removeNodeFromMap(){console.error(Fr)},has:()=>(console.error(Fr),!1),reset(){console.error(Fr)}};function Or(t,e,r){void 0===r&&(r={});var i=null,n=0;return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];var u=Date.now();n||!1!==r.leading||(n=u);var l=e-(u-n),d=this;l<=0||l>e?(i&&(clearTimeout(i),i=null),n=u,t.apply(d,s)):i||!1===r.trailing||(i=setTimeout((()=>{n=!1===r.leading?0:Date.now(),i=null,t.apply(d,s)}),l))}}function xr(t,e,r,i,n){void 0===n&&(n=window);var o=n.Object.getOwnPropertyDescriptor(t,e);return n.Object.defineProperty(t,e,i?r:{set(t){setTimeout((()=>{r.set.call(this,t)}),0),o&&o.set&&o.set.call(this,t)}}),()=>xr(t,e,o||{},!0)}function Zr(t,e,r){try{if(!(e in t))return()=>{};var i=t[e],n=r(i);return"function"==typeof n&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:i}})),t[e]=n,()=>{t[e]=i}}catch(t){return()=>{}}}"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Br=new Proxy(Br,{get:(t,e,r)=>("map"===e&&console.error(Fr),Reflect.get(t,e,r))}));var Yr=Date.now;function Er(t){var e,r,i,n,o=t.document;return{left:o.scrollingElement?o.scrollingElement.scrollLeft:void 0!==t.pageXOffset?t.pageXOffset:o.documentElement.scrollLeft||(null==o?void 0:o.body)&&(null==(e=_r.parentElement(o.body))?void 0:e.scrollLeft)||(null==(r=null==o?void 0:o.body)?void 0:r.scrollLeft)||0,top:o.scrollingElement?o.scrollingElement.scrollTop:void 0!==t.pageYOffset?t.pageYOffset:(null==o?void 0:o.documentElement.scrollTop)||(null==o?void 0:o.body)&&(null==(i=_r.parentElement(o.body))?void 0:i.scrollTop)||(null==(n=null==o?void 0:o.body)?void 0:n.scrollTop)||0}}function Gr(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function Lr(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function Wr(t){return t?t.nodeType===t.ELEMENT_NODE?t:_r.parentElement(t):null}function Dr(t,e,r,i){if(!t)return!1;var n=Wr(t);if(!n)return!1;try{if("string"==typeof e){if(n.classList.contains(e))return!0;if(i&&null!==n.closest("."+e))return!0}else if(fr(n,e,i))return!0}catch(t){}if(r){if(n.matches(r))return!0;if(i&&null!==n.closest(r))return!0}return!1}function Vr(t,e,r){return!("TITLE"!==t.tagName||!r.headTitleMutations)||e.getId(t)===nr}function Xr(t,e){if(Ge(t))return!1;var r=e.getId(t);if(!e.has(r))return!0;var i=_r.parentNode(t);return(!i||i.nodeType!==t.DOCUMENT_NODE)&&(!i||Xr(i,e))}function zr(t){return Boolean(t.changedTouches)}function Jr(t,e){return Boolean("IFRAME"===t.nodeName&&e.getMeta(t))}function Kr(t,e){return Boolean("LINK"===t.nodeName&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&"stylesheet"===t.getAttribute("rel")&&e.getMeta(t))}function Hr(t){return!!t&&(t instanceof yr&&"shadowRoot"in t?Boolean(t.shadowRoot):Boolean(_r.shadowRoot(t)))}/[1-9][0-9]{12}/.test(Date.now().toString())||(Yr=()=>(new Date).getTime());let jr=class{constructor(){ke(this,"id",1),ke(this,"styleIDMap",new WeakMap),ke(this,"idStyleMap",new Map)}getId(t){var e;return null!==(e=this.styleIDMap.get(t))&&void 0!==e?e:-1}has(t){return this.styleIDMap.has(t)}add(t,e){return this.has(t)?this.getId(t):(r=void 0===e?this.id++:e,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r);var r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}};function Ur(t){var e,r=null;return"getRootNode"in t&&(null==(e=_r.getRootNode(t))?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&_r.host(_r.getRootNode(t))&&(r=_r.host(_r.getRootNode(t))),r}function Pr(t){var e=t.ownerDocument;if(!e)return!1;var r=function(t){for(var e,r=t;e=Ur(r);)r=e;return r}(t);return _r.contains(e,r)}function qr(t){var e=t.ownerDocument;return!!e&&(_r.contains(e,t)||Pr(t))}var Qr=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(Qr||{}),$r=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))($r||{}),ti=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(ti||{}),ei=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(ei||{}),ri=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(ri||{}),ii=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange",t[t.RateChange=4]="RateChange",t))(ii||{});function ni(t){return"__ln"in t}class oi{constructor(){ke(this,"length",0),ke(this,"head",null),ke(this,"tail",null)}get(t){if(t>=this.length)throw new Error("Position outside of list range");for(var e=this.head,r=0;r<t;r++)e=(null==e?void 0:e.next)||null;return e}addNode(t){var e={value:t,previous:null,next:null};if(t.__ln=e,t.previousSibling&&ni(t.previousSibling)){var r=t.previousSibling.__ln.next;e.next=r,e.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=e,r&&(r.previous=e)}else if(t.nextSibling&&ni(t.nextSibling)&&t.nextSibling.__ln.previous){var i=t.nextSibling.__ln.previous;e.previous=i,e.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=e,i&&(i.next=e)}else this.head&&(this.head.previous=e),e.next=this.head,this.head=e;null===e.next&&(this.tail=e),this.length++}removeNode(t){var e=t.__ln;this.head&&(e.previous?(e.previous.next=e.next,e.next?e.next.previous=e.previous:this.tail=e.previous):(this.head=e.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}var si,ai=(t,e)=>t+"@"+e;class ui{constructor(){ke(this,"frozen",!1),ke(this,"locked",!1),ke(this,"texts",[]),ke(this,"attributes",[]),ke(this,"attributeMap",new WeakMap),ke(this,"removes",[]),ke(this,"mapRemoves",[]),ke(this,"movedMap",{}),ke(this,"addedSet",new Set),ke(this,"movedSet",new Set),ke(this,"droppedSet",new Set),ke(this,"mutationCb"),ke(this,"blockClass"),ke(this,"blockSelector"),ke(this,"maskTextClass"),ke(this,"maskTextSelector"),ke(this,"inlineStylesheet"),ke(this,"maskInputOptions"),ke(this,"maskTextFn"),ke(this,"maskInputFn"),ke(this,"keepIframeSrcFn"),ke(this,"recordCanvas"),ke(this,"inlineImages"),ke(this,"slimDOMOptions"),ke(this,"dataURLOptions"),ke(this,"doc"),ke(this,"mirror"),ke(this,"iframeManager"),ke(this,"stylesheetManager"),ke(this,"shadowDomManager"),ke(this,"canvasManager"),ke(this,"processedNodeManager"),ke(this,"unattachedDoc"),ke(this,"processMutations",(t=>{t.forEach(this.processMutation),this.emit()})),ke(this,"emit",(()=>{if(!this.frozen&&!this.locked){for(var t=[],e=new Set,r=new oi,i=t=>{for(var e=t,r=nr;r===nr;)r=(e=e&&e.nextSibling)&&this.mirror.getId(e);return r},n=n=>{var o=_r.parentNode(n);if(o&&qr(n)&&"TEXTAREA"!==o.tagName){var s=Ge(o)?this.mirror.getId(Ur(n)):this.mirror.getId(o),a=i(n);if(-1===s||-1===a)return r.addNode(n);var u=Ir(n,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:t=>{Jr(t,this.mirror)&&this.iframeManager.addIframe(t),Kr(t,this.mirror)&&this.stylesheetManager.trackLinkElement(t),Hr(n)&&this.shadowDomManager.addShadowRoot(_r.shadowRoot(n),this.doc)},onIframeLoad:(t,e)=>{this.iframeManager.attachIframe(t,e),this.shadowDomManager.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{this.stylesheetManager.attachLinkElement(t,e)}});u&&(t.push({parentId:s,nextId:a,node:u}),e.add(u.id))}};this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(var o of this.movedSet)di(this.removes,o,this.mirror)&&!this.movedSet.has(_r.parentNode(o))||n(o);for(var s of this.addedSet)ci(this.droppedSet,s)||di(this.removes,s,this.mirror)?ci(this.movedSet,s)?n(s):this.droppedSet.add(s):n(s);for(var a=null;r.length;){var u=null;if(a){var l=this.mirror.getId(_r.parentNode(a.value)),d=i(a.value);-1!==l&&-1!==d&&(u=a)}if(!u)for(var c=r.tail;c;){var h=c;if(c=c.previous,h){var v=this.mirror.getId(_r.parentNode(h.value));if(-1===i(h.value))continue;if(-1!==v){u=h;break}var f=h.value,m=_r.parentNode(f);if(m&&m.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var p=_r.host(m);if(-1!==this.mirror.getId(p)){u=h;break}}}}if(!u){for(;r.head;)r.removeNode(r.head.value);break}a=u.previous,r.removeNode(u.value),n(u.value)}var g={texts:this.texts.map((t=>{var e=t.node,r=_r.parentNode(e);return r&&"TEXTAREA"===r.tagName&&this.genTextAreaValueMutation(r),{id:this.mirror.getId(e),value:t.value}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),attributes:this.attributes.map((t=>{var{attributes:e}=t;if("string"==typeof e.style){var r=JSON.stringify(t.styleDiff),i=JSON.stringify(t._unchangedStyles);r.length<e.style.length&&(r+i).split("var(").length===e.style.split("var(").length&&(e.style=t.styleDiff)}return{id:this.mirror.getId(t.node),attributes:e}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),removes:this.removes,adds:t};(g.texts.length||g.attributes.length||g.removes.length||g.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(g))}})),ke(this,"genTextAreaValueMutation",(t=>{var e=this.attributeMap.get(t);e||(e={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(e),this.attributeMap.set(t,e)),e.attributes.value=Array.from(_r.childNodes(t),(t=>_r.textContent(t)||"")).join("")})),ke(this,"processMutation",(t=>{if(!Vr(t.target,this.mirror,this.slimDOMOptions))switch(t.type){case"characterData":var e=_r.textContent(t.target);Dr(t.target,this.blockClass,this.blockSelector,!1)||e===t.oldValue||this.texts.push({value:mr(t.target,this.maskTextClass,this.maskTextSelector,!0)&&e?this.maskTextFn?this.maskTextFn(e,Wr(t.target)):e.replace(/[\S]/g,"*"):e,node:t.target});break;case"attributes":var r=t.target,i=t.attributeName,n=t.target.getAttribute(i);if("value"===i){var o=He(r);n=ze({element:r,maskInputOptions:this.maskInputOptions,tagName:r.tagName,type:o,value:n,maskInputFn:this.maskInputFn})}if(Dr(t.target,this.blockClass,this.blockSelector,!1)||n===t.oldValue)return;var s=this.attributeMap.get(t.target);if("IFRAME"===r.tagName&&"src"===i&&!this.keepIframeSrcFn(n)){if(r.contentDocument)return;i="rr_src"}if(s||(s={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(s),this.attributeMap.set(t.target,s)),"type"===i&&"INPUT"===r.tagName&&"password"===(t.oldValue||"").toLowerCase()&&r.setAttribute("data-rr-is-password","true"),!vr(r.tagName,i))if(s.attributes[i]=hr(this.doc,Je(r.tagName),Je(i),n),"style"===i){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(t){this.unattachedDoc=this.doc}var a=this.unattachedDoc.createElement("span");for(var u of(t.oldValue&&a.setAttribute("style",t.oldValue),Array.from(r.style))){var l=r.style.getPropertyValue(u),d=r.style.getPropertyPriority(u);l!==a.style.getPropertyValue(u)||d!==a.style.getPropertyPriority(u)?s.styleDiff[u]=""===d?l:[l,d]:s._unchangedStyles[u]=[l,d]}for(var c of Array.from(a.style))""===r.style.getPropertyValue(c)&&(s.styleDiff[c]=!1)}else"open"===i&&"DIALOG"===r.tagName&&(r.matches("dialog:modal")?s.attributes.rr_open_mode="modal":s.attributes.rr_open_mode="non-modal");break;case"childList":if(Dr(t.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===t.target.tagName)return void this.genTextAreaValueMutation(t.target);t.addedNodes.forEach((e=>this.genAdds(e,t.target))),t.removedNodes.forEach((e=>{var r=this.mirror.getId(e),i=Ge(t.target)?this.mirror.getId(_r.host(t.target)):this.mirror.getId(t.target);Dr(t.target,this.blockClass,this.blockSelector,!1)||Vr(e,this.mirror,this.slimDOMOptions)||!function(t,e){return-1!==e.getId(t)}(e,this.mirror)||(this.addedSet.has(e)?(li(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(t.target)&&-1===r||Xr(t.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[ai(r,i)]?li(this.movedSet,e):this.removes.push({parentId:i,id:r,isShadow:!(!Ge(t.target)||!Le(t.target))||void 0})),this.mapRemoves.push(e))}))}})),ke(this,"genAdds",((t,e)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!this.addedSet.has(t)&&!this.movedSet.has(t)){if(this.mirror.hasNode(t)){if(Vr(t,this.mirror,this.slimDOMOptions))return;this.movedSet.add(t);var r=null;e&&this.mirror.hasNode(e)&&(r=this.mirror.getId(e)),r&&-1!==r&&(this.movedMap[ai(this.mirror.getId(t),r)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);Dr(t,this.blockClass,this.blockSelector,!1)||(_r.childNodes(t).forEach((t=>this.genAdds(t))),Hr(t)&&_r.childNodes(_r.shadowRoot(t)).forEach((e=>{this.processedNodeManager.add(e,this),this.genAdds(e,t)})))}}))}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((e=>{this[e]=t[e]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function li(t,e){t.delete(e),_r.childNodes(e).forEach((e=>li(t,e)))}function di(t,e,r){return 0!==t.length&&function(t,e,r){var i,n=_r.parentNode(e),o=function(){var e=r.getId(n);if(t.some((t=>t.id===e)))return{v:!0};n=_r.parentNode(n)};for(;n;)if(i=o())return i.v;return!1}(t,e,r)}function ci(t,e){return 0!==t.size&&hi(t,e)}function hi(t,e){var r=_r.parentNode(e);return!!r&&(!!t.has(r)||hi(t,r))}var vi=t=>{if(!si)return t;return function(){try{return t(...arguments)}catch(t){if(si&&!0===si(t))return;throw t}}},fi=[];function mi(t){try{if("composedPath"in t){var e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch(t){}return t&&t.target}function pi(t,e){var r=new ui;fi.push(r),r.init(t);var i=new(Tr())(vi(r.processMutations.bind(r)));return i.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),i}function gi(t){var{mouseInteractionCb:e,doc:r,mirror:i,blockClass:n,blockSelector:o,sampling:s}=t;if(!1===s.mouseInteraction)return()=>{};var a=!0===s.mouseInteraction||void 0===s.mouseInteraction?{}:s.mouseInteraction,l=[],d=null;return Object.keys(ti).filter((t=>Number.isNaN(Number(t))&&!t.endsWith("_Departed")&&!1!==a[t])).forEach((t=>{var s=Je(t),a=(t=>r=>{var s=mi(r);if(!Dr(s,n,o,!0)){var a=null,l=t;if("pointerType"in r){switch(r.pointerType){case"mouse":a=ei.Mouse;break;case"touch":a=ei.Touch;break;case"pen":a=ei.Pen}a===ei.Touch?ti[t]===ti.MouseDown?l="TouchStart":ti[t]===ti.MouseUp&&(l="TouchEnd"):ei.Pen}else zr(r)&&(a=ei.Touch);null!==a?(d=a,(l.startsWith("Touch")&&a===ei.Touch||l.startsWith("Mouse")&&a===ei.Mouse)&&(a=null)):ti[t]===ti.Click&&(a=d,d=null);var c=zr(r)?r.changedTouches[0]:r;if(c){var h=i.getId(s),{clientX:v,clientY:f}=c;vi(e)(u({type:ti[l],id:h,x:v,y:f},null!==a&&{pointerType:a}))}}})(t);if(window.PointerEvent)switch(ti[t]){case ti.MouseDown:case ti.MouseUp:s=s.replace("mouse","pointer");break;case ti.TouchStart:case ti.TouchEnd:return}l.push(Mr(s,a,r))})),vi((()=>{l.forEach((t=>t()))}))}function Ii(t){var{scrollCb:e,doc:r,mirror:i,blockClass:n,blockSelector:o,sampling:s}=t;return Mr("scroll",vi(Or(vi((t=>{var s=mi(t);if(s&&!Dr(s,n,o,!0)){var a=i.getId(s);if(s===r&&r.defaultView){var u=Er(r.defaultView);e({id:a,x:u.left,y:u.top})}else e({id:a,x:s.scrollLeft,y:s.scrollTop})}})),s.scroll||100)),r)}var yi=["INPUT","TEXTAREA","SELECT"],bi=new WeakMap;function Ci(t){return function(t,e){if(Ai("CSSGroupingRule")&&t.parentRule instanceof CSSGroupingRule||Ai("CSSMediaRule")&&t.parentRule instanceof CSSMediaRule||Ai("CSSSupportsRule")&&t.parentRule instanceof CSSSupportsRule||Ai("CSSConditionRule")&&t.parentRule instanceof CSSConditionRule){var r=Array.from(t.parentRule.cssRules).indexOf(t);e.unshift(r)}else if(t.parentStyleSheet){var i=Array.from(t.parentStyleSheet.cssRules).indexOf(t);e.unshift(i)}return e}(t,[])}function wi(t,e,r){var i,n;return t?(t.ownerNode?i=e.getId(t.ownerNode):n=r.getId(t),{styleId:n,id:i}):{}}function Si(t,e){var r,i,n,{mirror:o,stylesheetManager:s}=t,a=null;a="#document"===e.nodeName?o.getId(e):o.getId(_r.host(e));var u="#document"===e.nodeName?null==(r=e.defaultView)?void 0:r.Document:null==(n=null==(i=e.ownerDocument)?void 0:i.defaultView)?void 0:n.ShadowRoot,l=(null==u?void 0:u.prototype)?Object.getOwnPropertyDescriptor(null==u?void 0:u.prototype,"adoptedStyleSheets"):void 0;return null!==a&&-1!==a&&u&&l?(Object.defineProperty(e,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var t;return null==(t=l.get)?void 0:t.call(this)},set(t){var e,r=null==(e=l.set)?void 0:e.call(this,t);if(null!==a&&-1!==a)try{s.adoptStyleSheets(t,a)}catch(t){}return r}}),vi((()=>{Object.defineProperty(e,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}))):()=>{}}function ki(t,e){void 0===e&&(e={});var r,i=t.doc.defaultView;if(!i)return()=>{};!function(t,e){var{mutationCb:r,mousemoveCb:i,mouseInteractionCb:n,scrollCb:o,viewportResizeCb:s,inputCb:a,mediaInteractionCb:u,styleSheetRuleCb:l,styleDeclarationCb:d,canvasMutationCb:c,fontCb:h,selectionCb:v,customElementCb:f}=t;t.mutationCb=function(){e.mutation&&e.mutation(...arguments),r(...arguments)},t.mousemoveCb=function(){e.mousemove&&e.mousemove(...arguments),i(...arguments)},t.mouseInteractionCb=function(){e.mouseInteraction&&e.mouseInteraction(...arguments),n(...arguments)},t.scrollCb=function(){e.scroll&&e.scroll(...arguments),o(...arguments)},t.viewportResizeCb=function(){e.viewportResize&&e.viewportResize(...arguments),s(...arguments)},t.inputCb=function(){e.input&&e.input(...arguments),a(...arguments)},t.mediaInteractionCb=function(){e.mediaInteaction&&e.mediaInteaction(...arguments),u(...arguments)},t.styleSheetRuleCb=function(){e.styleSheetRule&&e.styleSheetRule(...arguments),l(...arguments)},t.styleDeclarationCb=function(){e.styleDeclaration&&e.styleDeclaration(...arguments),d(...arguments)},t.canvasMutationCb=function(){e.canvasMutation&&e.canvasMutation(...arguments),c(...arguments)},t.fontCb=function(){e.font&&e.font(...arguments),h(...arguments)},t.selectionCb=function(){e.selection&&e.selection(...arguments),v(...arguments)},t.customElementCb=function(){e.customElement&&e.customElement(...arguments),f(...arguments)}}(t,e),t.recordDOM&&(r=pi(t,t.doc));var n=function(t){var{mousemoveCb:e,sampling:r,doc:i,mirror:n}=t;if(!1===r.mousemove)return()=>{};var o,s="number"==typeof r.mousemove?r.mousemove:50,a="number"==typeof r.mousemoveCallback?r.mousemoveCallback:500,u=[],l=Or(vi((t=>{var r=Date.now()-o;e(u.map((t=>(t.timeOffset-=r,t))),t),u=[],o=null})),a),d=vi(Or(vi((t=>{var e=mi(t),{clientX:r,clientY:i}=zr(t)?t.changedTouches[0]:t;o||(o=Yr()),u.push({x:r,y:i,id:n.getId(e),timeOffset:Yr()-o}),l("undefined"!=typeof DragEvent&&t instanceof DragEvent?$r.Drag:t instanceof MouseEvent?$r.MouseMove:$r.TouchMove)})),s,{trailing:!1})),c=[Mr("mousemove",d,i),Mr("touchmove",d,i),Mr("drag",d,i)];return vi((()=>{c.forEach((t=>t()))}))}(t),o=gi(t),s=Ii(t),a=function(t,e){var{viewportResizeCb:r}=t,{win:i}=e,n=-1,o=-1;return Mr("resize",vi(Or(vi((()=>{var t=Gr(),e=Lr();n===t&&o===e||(r({width:Number(e),height:Number(t)}),n=t,o=e)})),200)),i)}(t,{win:i}),l=function(t){var{inputCb:e,doc:r,mirror:i,blockClass:n,blockSelector:o,ignoreClass:s,ignoreSelector:a,maskInputOptions:l,maskInputFn:d,sampling:c,userTriggeredOnInput:h}=t;function v(t){var e=mi(t),i=t.isTrusted,u=e&&e.tagName;if(e&&"OPTION"===u&&(e=_r.parentElement(e)),e&&u&&!(yi.indexOf(u)<0)&&!Dr(e,n,o,!0)&&!(e.classList.contains(s)||a&&e.matches(a))){var c=e.value,v=!1,m=He(e)||"";"radio"===m||"checkbox"===m?v=e.checked:(l[u.toLowerCase()]||l[m])&&(c=ze({element:e,maskInputOptions:l,tagName:u,type:m,value:c,maskInputFn:d})),f(e,h?{text:c,isChecked:v,userTriggered:i}:{text:c,isChecked:v});var p=e.name;"radio"===m&&p&&v&&r.querySelectorAll('input[type="radio"][name="'+p+'"]').forEach((t=>{if(t!==e){var r=t.value;f(t,h?{text:r,isChecked:!v,userTriggered:!1}:{text:r,isChecked:!v})}}))}}function f(t,r){var n=bi.get(t);if(!n||n.text!==r.text||n.isChecked!==r.isChecked){bi.set(t,r);var o=i.getId(t);vi(e)(u({},r,{id:o}))}}var m=("last"===c.input?["change"]:["input","change"]).map((t=>Mr(t,vi(v),r))),p=r.defaultView;if(!p)return()=>{m.forEach((t=>t()))};var g=p.Object.getOwnPropertyDescriptor(p.HTMLInputElement.prototype,"value"),I=[[p.HTMLInputElement.prototype,"value"],[p.HTMLInputElement.prototype,"checked"],[p.HTMLSelectElement.prototype,"value"],[p.HTMLTextAreaElement.prototype,"value"],[p.HTMLSelectElement.prototype,"selectedIndex"],[p.HTMLOptionElement.prototype,"selected"]];return g&&g.set&&m.push(...I.map((t=>xr(t[0],t[1],{set(){vi(v)({target:this,isTrusted:!1})}},!1,p)))),vi((()=>{m.forEach((t=>t()))}))}(t),d=function(t){var{mediaInteractionCb:e,blockClass:r,blockSelector:i,mirror:n,sampling:o,doc:s}=t,a=vi((t=>Or(vi((o=>{var s=mi(o);if(s&&!Dr(s,r,i,!0)){var{currentTime:a,volume:u,muted:l,playbackRate:d,loop:c}=s;e({type:t,id:n.getId(s),currentTime:a,volume:u,muted:l,playbackRate:d,loop:c})}})),o.media||500))),u=[Mr("play",a(ii.Play),s),Mr("pause",a(ii.Pause),s),Mr("seeked",a(ii.Seeked),s),Mr("volumechange",a(ii.VolumeChange),s),Mr("ratechange",a(ii.RateChange),s)];return vi((()=>{u.forEach((t=>t()))}))}(t),c=()=>{},h=()=>{},v=()=>{},f=()=>{};t.recordDOM&&(c=function(t,e){var{styleSheetRuleCb:r,mirror:i,stylesheetManager:n}=t,{win:o}=e;if(!o.CSSStyleSheet||!o.CSSStyleSheet.prototype)return()=>{};var s=o.CSSStyleSheet.prototype.insertRule;o.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:vi(((t,e,o)=>{var[s,a]=o,{id:u,styleId:l}=wi(e,i,n.styleMirror);return(u&&-1!==u||l&&-1!==l)&&r({id:u,styleId:l,adds:[{rule:s,index:a}]}),t.apply(e,o)}))}),o.CSSStyleSheet.prototype.addRule=function(t,e,r){void 0===r&&(r=this.cssRules.length);var i=t+" { "+e+" }";return o.CSSStyleSheet.prototype.insertRule.apply(this,[i,r])};var a,u,l=o.CSSStyleSheet.prototype.deleteRule;o.CSSStyleSheet.prototype.deleteRule=new Proxy(l,{apply:vi(((t,e,o)=>{var[s]=o,{id:a,styleId:u}=wi(e,i,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&r({id:a,styleId:u,removes:[{index:s}]}),t.apply(e,o)}))}),o.CSSStyleSheet.prototype.removeRule=function(t){return o.CSSStyleSheet.prototype.deleteRule.apply(this,[t])},o.CSSStyleSheet.prototype.replace&&(a=o.CSSStyleSheet.prototype.replace,o.CSSStyleSheet.prototype.replace=new Proxy(a,{apply:vi(((t,e,o)=>{var[s]=o,{id:a,styleId:u}=wi(e,i,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&r({id:a,styleId:u,replace:s}),t.apply(e,o)}))})),o.CSSStyleSheet.prototype.replaceSync&&(u=o.CSSStyleSheet.prototype.replaceSync,o.CSSStyleSheet.prototype.replaceSync=new Proxy(u,{apply:vi(((t,e,o)=>{var[s]=o,{id:a,styleId:u}=wi(e,i,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&r({id:a,styleId:u,replaceSync:s}),t.apply(e,o)}))}));var d={};Ni("CSSGroupingRule")?d.CSSGroupingRule=o.CSSGroupingRule:(Ni("CSSMediaRule")&&(d.CSSMediaRule=o.CSSMediaRule),Ni("CSSConditionRule")&&(d.CSSConditionRule=o.CSSConditionRule),Ni("CSSSupportsRule")&&(d.CSSSupportsRule=o.CSSSupportsRule));var c={};return Object.entries(d).forEach((t=>{var[e,o]=t;c[e]={insertRule:o.prototype.insertRule,deleteRule:o.prototype.deleteRule},o.prototype.insertRule=new Proxy(c[e].insertRule,{apply:vi(((t,e,o)=>{var[s,a]=o,{id:u,styleId:l}=wi(e.parentStyleSheet,i,n.styleMirror);return(u&&-1!==u||l&&-1!==l)&&r({id:u,styleId:l,adds:[{rule:s,index:[...Ci(e),a||0]}]}),t.apply(e,o)}))}),o.prototype.deleteRule=new Proxy(c[e].deleteRule,{apply:vi(((t,e,o)=>{var[s]=o,{id:a,styleId:u}=wi(e.parentStyleSheet,i,n.styleMirror);return(a&&-1!==a||u&&-1!==u)&&r({id:a,styleId:u,removes:[{index:[...Ci(e),s]}]}),t.apply(e,o)}))})})),vi((()=>{o.CSSStyleSheet.prototype.insertRule=s,o.CSSStyleSheet.prototype.deleteRule=l,a&&(o.CSSStyleSheet.prototype.replace=a),u&&(o.CSSStyleSheet.prototype.replaceSync=u),Object.entries(d).forEach((t=>{var[e,r]=t;r.prototype.insertRule=c[e].insertRule,r.prototype.deleteRule=c[e].deleteRule}))}))}(t,{win:i}),h=Si(t,t.doc),v=function(t,e){var{styleDeclarationCb:r,mirror:i,ignoreCSSAttributes:n,stylesheetManager:o}=t,{win:s}=e,a=s.CSSStyleDeclaration.prototype.setProperty;s.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:vi(((t,e,s)=>{var u,[l,d,c]=s;if(n.has(l))return a.apply(e,[l,d,c]);var{id:h,styleId:v}=wi(null==(u=e.parentRule)?void 0:u.parentStyleSheet,i,o.styleMirror);return(h&&-1!==h||v&&-1!==v)&&r({id:h,styleId:v,set:{property:l,value:d,priority:c},index:Ci(e.parentRule)}),t.apply(e,s)}))});var u=s.CSSStyleDeclaration.prototype.removeProperty;return s.CSSStyleDeclaration.prototype.removeProperty=new Proxy(u,{apply:vi(((t,e,s)=>{var a,[l]=s;if(n.has(l))return u.apply(e,[l]);var{id:d,styleId:c}=wi(null==(a=e.parentRule)?void 0:a.parentStyleSheet,i,o.styleMirror);return(d&&-1!==d||c&&-1!==c)&&r({id:d,styleId:c,remove:{property:l},index:Ci(e.parentRule)}),t.apply(e,s)}))}),vi((()=>{s.CSSStyleDeclaration.prototype.setProperty=a,s.CSSStyleDeclaration.prototype.removeProperty=u}))}(t,{win:i}),t.collectFonts&&(f=function(t){var{fontCb:e,doc:r}=t,i=r.defaultView;if(!i)return()=>{};var n=[],o=new WeakMap,s=i.FontFace;i.FontFace=function(t,e,r){var i=new s(t,e,r);return o.set(i,{family:t,buffer:"string"!=typeof e,descriptors:r,fontSource:"string"==typeof e?e:JSON.stringify(Array.from(new Uint8Array(e)))}),i};var a=Zr(r.fonts,"add",(function(t){return function(r){return setTimeout(vi((()=>{var t=o.get(r);t&&(e(t),o.delete(r))})),0),t.apply(this,[r])}}));return n.push((()=>{i.FontFace=s})),n.push(a),vi((()=>{n.forEach((t=>t()))}))}(t)));var m=function(t){var{doc:e,mirror:r,blockClass:i,blockSelector:n,selectionCb:o}=t,s=!0,a=vi((()=>{var t=e.getSelection();if(!(!t||s&&(null==t?void 0:t.isCollapsed))){s=t.isCollapsed||!1;for(var a=[],u=t.rangeCount||0,l=0;l<u;l++){var d=t.getRangeAt(l),{startContainer:c,startOffset:h,endContainer:v,endOffset:f}=d;Dr(c,i,n,!0)||Dr(v,i,n,!0)||a.push({start:r.getId(c),startOffset:h,end:r.getId(v),endOffset:f})}o({ranges:a})}}));return a(),Mr("selectionchange",a)}(t),p=function(t){var{doc:e,customElementCb:r}=t,i=e.defaultView;return i&&i.customElements?Zr(i.customElements,"define",(function(t){return function(e,i,n){try{r({define:{name:e}})}catch(t){console.warn("Custom element callback failed for "+e)}return t.apply(this,[e,i,n])}})):()=>{}}(t),g=[];for(var I of t.plugins)g.push(I.observer(I.callback,i,I.options));return vi((()=>{fi.forEach((t=>t.reset())),null==r||r.disconnect(),n(),o(),s(),a(),l(),d(),c(),h(),v(),f(),m(),p(),g.forEach((t=>t()))}))}function Ai(t){return void 0!==window[t]}function Ni(t){return Boolean(void 0!==window[t]&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class Ri{constructor(t){ke(this,"iframeIdToRemoteIdMap",new WeakMap),ke(this,"iframeRemoteIdToIdMap",new WeakMap),this.generateIdFn=t}getId(t,e,r,i){var n=r||this.getIdToRemoteIdMap(t),o=i||this.getRemoteIdToIdMap(t),s=n.get(e);return s||(s=this.generateIdFn(),n.set(e,s),o.set(s,e)),s}getIds(t,e){var r=this.getIdToRemoteIdMap(t),i=this.getRemoteIdToIdMap(t);return e.map((e=>this.getId(t,e,r,i)))}getRemoteId(t,e,r){var i=r||this.getRemoteIdToIdMap(t);if("number"!=typeof e)return e;var n=i.get(e);return n||-1}getRemoteIds(t,e){var r=this.getRemoteIdToIdMap(t);return e.map((e=>this.getRemoteId(t,e,r)))}reset(t){if(!t)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(t),this.iframeRemoteIdToIdMap.delete(t)}getIdToRemoteIdMap(t){var e=this.iframeIdToRemoteIdMap.get(t);return e||(e=new Map,this.iframeIdToRemoteIdMap.set(t,e)),e}getRemoteIdToIdMap(t){var e=this.iframeRemoteIdToIdMap.get(t);return e||(e=new Map,this.iframeRemoteIdToIdMap.set(t,e)),e}}class Ti{constructor(t){ke(this,"iframes",new WeakMap),ke(this,"crossOriginIframeMap",new WeakMap),ke(this,"crossOriginIframeMirror",new Ri(or)),ke(this,"crossOriginIframeStyleMirror"),ke(this,"crossOriginIframeRootIdMap",new WeakMap),ke(this,"mirror"),ke(this,"mutationCb"),ke(this,"wrappedEmit"),ke(this,"loadListener"),ke(this,"stylesheetManager"),ke(this,"recordCrossOriginIframes"),this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Ri(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(t){this.iframes.set(t,!0),t.contentWindow&&this.crossOriginIframeMap.set(t.contentWindow,t)}addLoadListener(t){this.loadListener=t}attachIframe(t,e){var r,i;this.mutationCb({adds:[{parentId:this.mirror.getId(t),nextId:null,node:e}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),this.recordCrossOriginIframes&&(null==(r=t.contentWindow)||r.addEventListener("message",this.handleMessage.bind(this))),null==(i=this.loadListener)||i.call(this,t),t.contentDocument&&t.contentDocument.adoptedStyleSheets&&t.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(t.contentDocument.adoptedStyleSheets,this.mirror.getId(t.contentDocument))}handleMessage(t){var e=t;if("rrweb"===e.data.type&&e.origin===e.data.origin&&t.source){var r=this.crossOriginIframeMap.get(t.source);if(r){var i=this.transformCrossOriginEvent(r,e.data.event);i&&this.wrappedEmit(i,e.data.isCheckout)}}}transformCrossOriginEvent(t,e){var r;switch(e.type){case Qr.FullSnapshot:this.crossOriginIframeMirror.reset(t),this.crossOriginIframeStyleMirror.reset(t),this.replaceIdOnNode(e.data.node,t);var i=e.data.node.id;return this.crossOriginIframeRootIdMap.set(t,i),this.patchRootIdOnNode(e.data.node,i),{timestamp:e.timestamp,type:Qr.IncrementalSnapshot,data:{source:$r.Mutation,adds:[{parentId:this.mirror.getId(t),nextId:null,node:e.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case Qr.Meta:case Qr.Load:case Qr.DomContentLoaded:return!1;case Qr.Plugin:return e;case Qr.Custom:return this.replaceIds(e.data.payload,t,["id","parentId","previousId","nextId"]),e;case Qr.IncrementalSnapshot:switch(e.data.source){case $r.Mutation:return e.data.adds.forEach((e=>{this.replaceIds(e,t,["parentId","nextId","previousId"]),this.replaceIdOnNode(e.node,t);var r=this.crossOriginIframeRootIdMap.get(t);r&&this.patchRootIdOnNode(e.node,r)})),e.data.removes.forEach((e=>{this.replaceIds(e,t,["parentId","id"])})),e.data.attributes.forEach((e=>{this.replaceIds(e,t,["id"])})),e.data.texts.forEach((e=>{this.replaceIds(e,t,["id"])})),e;case $r.Drag:case $r.TouchMove:case $r.MouseMove:return e.data.positions.forEach((e=>{this.replaceIds(e,t,["id"])})),e;case $r.ViewportResize:return!1;case $r.MediaInteraction:case $r.MouseInteraction:case $r.Scroll:case $r.CanvasMutation:case $r.Input:return this.replaceIds(e.data,t,["id"]),e;case $r.StyleSheetRule:case $r.StyleDeclaration:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleId"]),e;case $r.Font:return e;case $r.Selection:return e.data.ranges.forEach((e=>{this.replaceIds(e,t,["start","end"])})),e;case $r.AdoptedStyleSheet:return this.replaceIds(e.data,t,["id"]),this.replaceStyleIds(e.data,t,["styleIds"]),null==(r=e.data.styles)||r.forEach((e=>{this.replaceStyleIds(e,t,["styleId"])})),e}}return!1}replace(t,e,r,i){for(var n of i)(Array.isArray(e[n])||"number"==typeof e[n])&&(Array.isArray(e[n])?e[n]=t.getIds(r,e[n]):e[n]=t.getId(r,e[n]));return e}replaceIds(t,e,r){return this.replace(this.crossOriginIframeMirror,t,e,r)}replaceStyleIds(t,e,r){return this.replace(this.crossOriginIframeStyleMirror,t,e,r)}replaceIdOnNode(t,e){this.replaceIds(t,e,["id","rootId"]),"childNodes"in t&&t.childNodes.forEach((t=>{this.replaceIdOnNode(t,e)}))}patchRootIdOnNode(t,e){t.type===Re.Document||t.rootId||(t.rootId=e),"childNodes"in t&&t.childNodes.forEach((t=>{this.patchRootIdOnNode(t,e)}))}}class _i{constructor(t){ke(this,"shadowDoms",new WeakSet),ke(this,"mutationCb"),ke(this,"scrollCb"),ke(this,"bypassOptions"),ke(this,"mirror"),ke(this,"restoreHandlers",[]),this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,e){if(Le(t)&&!this.shadowDoms.has(t)){this.shadowDoms.add(t);var r=pi(u({},this.bypassOptions,{doc:e,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push((()=>r.disconnect())),this.restoreHandlers.push(Ii(u({},this.bypassOptions,{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout((()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(_r.host(t))),this.restoreHandlers.push(Si({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))}),0)}}observeAttachShadow(t){t.contentWindow&&t.contentDocument&&this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,e){var r=this;this.restoreHandlers.push(Zr(t.prototype,"attachShadow",(function(t){return function(i){var n=t.call(this,i),o=_r.shadowRoot(this);return o&&qr(this)&&r.addShadowRoot(o,e),n}})))}reset(){this.restoreHandlers.forEach((t=>{try{t()}catch(t){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Mi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fi="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Bi=0;Bi<64;Bi++)Fi[Mi.charCodeAt(Bi)]=Bi;var Oi=new Map;var xi=(t,e,r)=>{if(t&&(Ei(t,e)||"object"==typeof t)){var i=function(t,e){var r=Oi.get(t);return r||(r=new Map,Oi.set(t,r)),r.has(e)||r.set(e,[]),r.get(e)}(r,t.constructor.name),n=i.indexOf(t);return-1===n&&(n=i.length,i.push(t)),n}};function Zi(t,e,r){if(t instanceof Array)return t.map((t=>Zi(t,e,r)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer)return{rr_type:t.constructor.name,base64:function(t){var e,r=new Uint8Array(t),i=r.length,n="";for(e=0;e<i;e+=3)n+=Mi[r[e]>>2],n+=Mi[(3&r[e])<<4|r[e+1]>>4],n+=Mi[(15&r[e+1])<<2|r[e+2]>>6],n+=Mi[63&r[e+2]];return i%3==2?n=n.substring(0,n.length-1)+"=":i%3==1&&(n=n.substring(0,n.length-2)+"=="),n}(t)};if(t instanceof DataView)return{rr_type:t.constructor.name,args:[Zi(t.buffer,e,r),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){var i=t.constructor.name,{src:n}=t;return{rr_type:i,src:n}}if(t instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:t.toDataURL()}}return t instanceof ImageData?{rr_type:t.constructor.name,args:[Zi(t.data,e,r),t.width,t.height]}:Ei(t,e)||"object"==typeof t?{rr_type:t.constructor.name,index:xi(t,e,r)}:t}var Yi=(t,e,r)=>t.map((t=>Zi(t,e,r))),Ei=(t,e)=>{var r=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(r.find((r=>t instanceof e[r])))};function Gi(t,e,r,i){var n=[];try{var o=Zr(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(n){for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];if(!Dr(this,e,r,!0)){var u=function(t){return"experimental-webgl"===t?"webgl":t}(n);if("__context"in this||(this.__context=u),i&&["webgl","webgl2"].includes(u))if(s[0]&&"object"==typeof s[0]){var l=s[0];l.preserveDrawingBuffer||(l.preserveDrawingBuffer=!0)}else s.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[n,...s])}}));n.push(o)}catch(t){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{n.forEach((t=>t()))}}function Li(t,e,r,i,n,o){var s=[],a=Object.getOwnPropertyNames(t),u=function(a){if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(a))return 0;try{if("function"!=typeof t[a])return 0;var u=Zr(t,a,(function(t){return function(){for(var s=arguments.length,u=new Array(s),l=0;l<s;l++)u[l]=arguments[l];var d=t.apply(this,u);if(xi(d,o,this),"tagName"in this.canvas&&!Dr(this.canvas,i,n,!0)){var c=Yi(u,o,this),h={type:e,property:a,args:c};r(this.canvas,h)}return d}}));s.push(u)}catch(i){var l=xr(t,a,{set(t){r(this.canvas,{type:e,property:a,args:[t],setter:!0})}});s.push(l)}};for(var l of a)u(l);return s}var Wi,Di,Vi,Xi,zi="KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=",Ji="undefined"!=typeof window&&window.Blob&&new Blob([(Wi=zi,Uint8Array.from(atob(Wi),(t=>t.charCodeAt(0))))],{type:"text/javascript;charset=utf-8"});function Ki(t){var e;try{if(!(e=Ji&&(window.URL||window.webkitURL).createObjectURL(Ji)))throw"";var r=new Worker(e,{name:null==t?void 0:t.name});return r.addEventListener("error",(()=>{(window.URL||window.webkitURL).revokeObjectURL(e)})),r}catch(e){return new Worker("data:text/javascript;base64,"+zi,{name:null==t?void 0:t.name})}finally{e&&(window.URL||window.webkitURL).revokeObjectURL(e)}}class Hi{constructor(t){ke(this,"pendingCanvasMutations",new Map),ke(this,"rafStamps",{latestId:0,invokeId:null}),ke(this,"mirror"),ke(this,"mutationCb"),ke(this,"resetObservers"),ke(this,"frozen",!1),ke(this,"locked",!1),ke(this,"processMutation",((t,e)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)}));var{sampling:e="all",win:r,blockClass:i,blockSelector:n,recordCanvas:o,dataURLOptions:s}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,o&&"all"===e&&this.initCanvasMutationObserver(r,i,n),o&&"number"==typeof e&&this.initCanvasFPSObserver(e,r,i,n,{dataURLOptions:s})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(t,e,r,i,n){var o=this,s=Gi(e,r,i,!0),u=new Map,l=new Ki;l.onmessage=t=>{var{id:e}=t.data;if(u.set(e,!1),"base64"in t.data){var{base64:r,type:i,width:n,height:o}=t.data;this.mutationCb({id:e,type:ri["2D"],commands:[{property:"clearRect",args:[0,0,n,o]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:i}]},0,0]}]})}};var d,c=1e3/t,h=0,v=t=>{var s,f;h&&t-h<c?d=requestAnimationFrame(v):(h=t,(s=[],f=t=>{t.querySelectorAll("canvas").forEach((t=>{Dr(t,r,i,!0)||s.push(t)})),t.querySelectorAll("*").forEach((t=>{t.shadowRoot&&f(t.shadowRoot)}))},f(e.document),s).forEach(function(){var t=a((function*(t){var e,r=o.mirror.getId(t);if(!u.get(r)&&0!==t.width&&0!==t.height){if(u.set(r,!0),["webgl","webgl2"].includes(t.__context)){var i=t.getContext(t.__context);!1===(null==(e=null==i?void 0:i.getContextAttributes())?void 0:e.preserveDrawingBuffer)&&i.clear(i.COLOR_BUFFER_BIT)}var s=t.clientWidth||t.width,a=t.clientHeight||t.height,d=yield createImageBitmap(t,{resizeWidth:s,resizeHeight:a});l.postMessage({id:r,bitmap:d,width:s,height:a,dataURLOptions:n.dataURLOptions},[d])}}));return function(e){return t.apply(this,arguments)}}()),d=requestAnimationFrame(v))};d=requestAnimationFrame(v),this.resetObservers=()=>{s(),cancelAnimationFrame(d)}}initCanvasMutationObserver(t,e,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var i=Gi(t,e,r,!1),n=function(t,e,r,i){var n=[],o=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype),s=function(o){try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[o])return 1;var s=Zr(e.CanvasRenderingContext2D.prototype,o,(function(n){return function(){for(var s=arguments.length,a=new Array(s),u=0;u<s;u++)a[u]=arguments[u];return Dr(this.canvas,r,i,!0)||setTimeout((()=>{var r=Yi(a,e,this);t(this.canvas,{type:ri["2D"],property:o,args:r})}),0),n.apply(this,a)}}));n.push(s)}catch(r){var a=xr(e.CanvasRenderingContext2D.prototype,o,{set(e){t(this.canvas,{type:ri["2D"],property:o,args:[e],setter:!0})}});n.push(a)}};for(var a of o)s(a);return()=>{n.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,r),o=function(t,e,r,i){var n=[];return n.push(...Li(e.WebGLRenderingContext.prototype,ri.WebGL,t,r,i,e)),void 0!==e.WebGL2RenderingContext&&n.push(...Li(e.WebGL2RenderingContext.prototype,ri.WebGL2,t,r,i,e)),()=>{n.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,r);this.resetObservers=()=>{i(),n(),o()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){var t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{var r=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,r)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(!this.frozen&&!this.locked){var r=this.pendingCanvasMutations.get(t);if(r&&-1!==e){var i=r.map((t=>{var e=function(t,e){if(null==t)return{};var r={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(-1!==e.indexOf(i))continue;r[i]=t[i]}return r}(t,we);return e})),{type:n}=r[0];this.mutationCb({id:e,type:n,commands:i}),this.pendingCanvasMutations.delete(t)}}}}class ji{constructor(t){ke(this,"trackedLinkElements",new WeakSet),ke(this,"mutationCb"),ke(this,"adoptedStyleSheetCb"),ke(this,"styleMirror",new jr),this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,e){"_cssText"in e.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:e.id,attributes:e.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,e){var r=this;if(0!==t.length){var i={id:e,styleIds:[]},n=[],o=function(t){var e;r.styleMirror.has(t)?e=r.styleMirror.getId(t):(e=r.styleMirror.add(t),n.push({styleId:e,rules:Array.from(t.rules||CSSRule,((e,r)=>({rule:De(e,t.href),index:r})))})),i.styleIds.push(e)};for(var s of t)o(s);n.length>0&&(i.styles=n),this.adoptedStyleSheetCb(i)}}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class Ui{constructor(){ke(this,"nodeMap",new WeakMap),ke(this,"active",!1)}inOtherBuffer(t,e){var r=this.nodeMap.get(t);return r&&Array.from(r).some((t=>t!==e))}add(t,e){this.active||(this.active=!0,requestAnimationFrame((()=>{this.nodeMap=new WeakMap,this.active=!1}))),this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(e))}destroy(){}}var Pi=!1;try{if(2!==Array.from([1],(t=>2*t))[0]){var qi=document.createElement("iframe");document.body.appendChild(qi),Array.from=(null==(Ce=qi.contentWindow)?void 0:Ce.Array.from)||Array.from,document.body.removeChild(qi)}}catch(t){console.debug("Unable to override Array.from",t)}var Qi,$i,tn=new Xe;function en(t){void 0===t&&(t={});var{emit:e,checkoutEveryNms:r,checkoutEveryNth:i,blockClass:n="rr-block",blockSelector:o=null,ignoreClass:s="rr-ignore",ignoreSelector:a=null,maskTextClass:l="rr-mask",maskTextSelector:d=null,inlineStylesheet:c=!0,maskAllInputs:h,maskInputOptions:v,slimDOMOptions:f,maskInputFn:m,maskTextFn:p,hooks:g,packFn:I,sampling:y={},dataURLOptions:b={},mousemoveWait:C,recordDOM:w=!0,recordCanvas:S=!1,recordCrossOriginIframes:k=!1,recordAfter:A=("DOMContentLoaded"===t.recordAfter?t.recordAfter:"load"),userTriggeredOnInput:N=!1,collectFonts:R=!1,inlineImages:T=!1,plugins:_,keepIframeSrcFn:M=(()=>!1),ignoreCSSAttributes:F=new Set([]),errorHandler:B}=t;si=B;var O=!k||window.parent===window,x=!1;if(!O)try{window.parent.document&&(x=!1)}catch(t){x=!0}if(O&&!e)throw new Error("emit function is required");if(!O&&!x)return()=>{};void 0!==C&&void 0===y.mousemove&&(y.mousemove=C),tn.reset();var Z,Y=!0===h?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==v?v:{password:!0},E=!0===f||"all"===f?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===f,headMetaDescKeywords:"all"===f,headTitleMutations:"all"===f}:f||{};!function(t){void 0===t&&(t=window),"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach)}();var G=0,L=t=>{for(var e of _||[])e.eventProcessor&&(t=e.eventProcessor(t));return I&&!x&&(t=I(t)),t};Di=(t,n)=>{var o,s=t;if(s.timestamp=Yr(),!(null==(o=fi[0])?void 0:o.isFrozen())||s.type===Qr.FullSnapshot||s.type===Qr.IncrementalSnapshot&&s.data.source===$r.Mutation||fi.forEach((t=>t.unfreeze())),O)null==e||e(L(s),n);else if(x){var a={type:"rrweb",event:L(s),origin:window.location.origin,isCheckout:n};window.parent.postMessage(a,"*")}if(s.type===Qr.FullSnapshot)Z=s,G=0;else if(s.type===Qr.IncrementalSnapshot){if(s.data.source===$r.Mutation&&s.data.isAttachIframe)return;G++;var u=i&&G>=i,l=r&&s.timestamp-Z.timestamp>r;(u||l)&&Vi(!0)}};var W=t=>{Di({type:Qr.IncrementalSnapshot,data:u({source:$r.Mutation},t)})},D=t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.Scroll},t)}),V=t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.CanvasMutation},t)}),X=new ji({mutationCb:W,adoptedStyleSheetCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.AdoptedStyleSheet},t)})}),z=new Ti({mirror:tn,mutationCb:W,stylesheetManager:X,recordCrossOriginIframes:k,wrappedEmit:Di});for(var J of _||[])J.getMirror&&J.getMirror({nodeMirror:tn,crossOriginIframeMirror:z.crossOriginIframeMirror,crossOriginIframeStyleMirror:z.crossOriginIframeStyleMirror});var K=new Ui;Xi=new Hi({recordCanvas:S,mutationCb:V,win:window,blockClass:n,blockSelector:o,mirror:tn,sampling:y.canvas,dataURLOptions:b});var H=new _i({mutationCb:W,scrollCb:D,bypassOptions:{blockClass:n,blockSelector:o,maskTextClass:l,maskTextSelector:d,inlineStylesheet:c,maskInputOptions:Y,dataURLOptions:b,maskTextFn:p,maskInputFn:m,recordCanvas:S,inlineImages:T,sampling:y,slimDOMOptions:E,iframeManager:z,stylesheetManager:X,canvasManager:Xi,keepIframeSrcFn:M,processedNodeManager:K},mirror:tn});Vi=function(t){if(void 0===t&&(t=!1),w){Di({type:Qr.Meta,data:{href:window.location.href,width:Lr(),height:Gr()}},t),X.reset(),H.init(),fi.forEach((t=>t.lock()));var e=function(t,e){var{mirror:r=new Xe,blockClass:i="rr-block",blockSelector:n=null,maskTextClass:o="rr-mask",maskTextSelector:s=null,inlineStylesheet:a=!0,inlineImages:u=!1,recordCanvas:l=!1,maskAllInputs:d=!1,maskTextFn:c,maskInputFn:h,slimDOM:v=!1,dataURLOptions:f,preserveWhiteSpace:m,onSerialize:p,onIframeLoad:g,iframeLoadTimeout:I,onStylesheetLoad:y,stylesheetLoadTimeout:b,keepIframeSrcFn:C=(()=>!1)}=e||{};return Ir(t,{doc:t,mirror:r,blockClass:i,blockSelector:n,maskTextClass:o,maskTextSelector:s,skipChild:!1,inlineStylesheet:a,maskInputOptions:!0===d?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===d?{password:!0}:d,maskTextFn:c,maskInputFn:h,slimDOMOptions:!0===v||"all"===v?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===v,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===v?{}:v,dataURLOptions:f,inlineImages:u,recordCanvas:l,preserveWhiteSpace:m,onSerialize:p,onIframeLoad:g,iframeLoadTimeout:I,onStylesheetLoad:y,stylesheetLoadTimeout:b,keepIframeSrcFn:C,newlyAddedElement:!1})}(document,{mirror:tn,blockClass:n,blockSelector:o,maskTextClass:l,maskTextSelector:d,inlineStylesheet:c,maskAllInputs:Y,maskTextFn:p,maskInputFn:m,slimDOM:E,dataURLOptions:b,recordCanvas:S,inlineImages:T,onSerialize:t=>{Jr(t,tn)&&z.addIframe(t),Kr(t,tn)&&X.trackLinkElement(t),Hr(t)&&H.addShadowRoot(_r.shadowRoot(t),document)},onIframeLoad:(t,e)=>{z.attachIframe(t,e),H.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{X.attachLinkElement(t,e)},keepIframeSrcFn:M});if(!e)return console.warn("Failed to snapshot the document");Di({type:Qr.FullSnapshot,data:{node:e,initialOffset:Er(window)}},t),fi.forEach((t=>t.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&X.adoptStyleSheets(document.adoptedStyleSheets,tn.getId(document))}};try{var j=[],U=t=>{var e;return vi(ki)({mutationCb:W,mousemoveCb:(t,e)=>Di({type:Qr.IncrementalSnapshot,data:{source:e,positions:t}}),mouseInteractionCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.MouseInteraction},t)}),scrollCb:D,viewportResizeCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.ViewportResize},t)}),inputCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.Input},t)}),mediaInteractionCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.MediaInteraction},t)}),styleSheetRuleCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.StyleSheetRule},t)}),styleDeclarationCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.StyleDeclaration},t)}),canvasMutationCb:V,fontCb:t=>Di({type:Qr.IncrementalSnapshot,data:u({source:$r.Font},t)}),selectionCb:t=>{Di({type:Qr.IncrementalSnapshot,data:u({source:$r.Selection},t)})},customElementCb:t=>{Di({type:Qr.IncrementalSnapshot,data:u({source:$r.CustomElement},t)})},blockClass:n,ignoreClass:s,ignoreSelector:a,maskTextClass:l,maskTextSelector:d,maskInputOptions:Y,inlineStylesheet:c,sampling:y,recordDOM:w,recordCanvas:S,inlineImages:T,userTriggeredOnInput:N,collectFonts:R,doc:t,maskInputFn:m,maskTextFn:p,keepIframeSrcFn:M,blockSelector:o,slimDOMOptions:E,dataURLOptions:b,mirror:tn,iframeManager:z,stylesheetManager:X,shadowDomManager:H,processedNodeManager:K,canvasManager:Xi,ignoreCSSAttributes:F,plugins:(null==(e=null==_?void 0:_.filter((t=>t.observer)))?void 0:e.map((t=>({observer:t.observer,options:t.options,callback:e=>Di({type:Qr.Plugin,data:{plugin:t.name,payload:e}})}))))||[]},g)};z.addLoadListener((t=>{try{j.push(U(t.contentDocument))}catch(t){console.warn(t)}}));var P=()=>{Vi(),j.push(U(document)),Pi=!0};return"interactive"===document.readyState||"complete"===document.readyState?P():(j.push(Mr("DOMContentLoaded",(()=>{Di({type:Qr.DomContentLoaded,data:{}}),"DOMContentLoaded"===A&&P()}))),j.push(Mr("load",(()=>{Di({type:Qr.Load,data:{}}),"load"===A&&P()}),window))),()=>{j.forEach((t=>t())),K.destroy(),Pi=!1,si=void 0}}catch(t){console.warn(t)}}en.addCustomEvent=(t,e)=>{if(!Pi)throw new Error("please add custom event after start recording");Di({type:Qr.Custom,data:{tag:t,payload:e}})},en.freezePage=()=>{fi.forEach((t=>t.freeze()))},en.takeFullSnapshot=t=>{if(!Pi)throw new Error("please take full snapshot after start recording");Vi(t)},en.mirror=tn,($i=Qi||(Qi={}))[$i.NotStarted=0]="NotStarted",$i[$i.Running=1]="Running",$i[$i.Stopped=2]="Stopped";var rn,nn=Object.defineProperty,on=(t,e,r)=>((t,e,r)=>e in t?nn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),sn=Object.defineProperty,an=(t,e,r)=>((t,e,r)=>e in t?sn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),un=Object.defineProperty,ln=(t,e,r)=>((t,e,r)=>e in t?un(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r)(t,"symbol"!=typeof e?e+"":e,r),dn={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},cn={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},hn={};function vn(t){if(hn[t])return hn[t];var e=globalThis[t],r=e.prototype,i=t in dn?dn[t]:void 0,n=Boolean(i&&i.every((t=>{var e,i;return Boolean(null==(i=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:i.toString().includes("[native code]"))}))),o=t in cn?cn[t]:void 0,s=Boolean(o&&o.every((t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))})));if(n&&s)return hn[t]=e.prototype,e.prototype;try{var a=document.createElement("iframe");document.body.appendChild(a);var u=a.contentWindow;if(!u)return e.prototype;var l=u[t].prototype;return document.body.removeChild(a),l?hn[t]=l:r}catch(t){return r}}var fn={};function mn(t,e,r){var i,n=t+"."+String(r);if(fn[n])return fn[n].call(e);var o=vn(t),s=null==(i=Object.getOwnPropertyDescriptor(o,r))?void 0:i.get;return s?(fn[n]=s,s.call(e)):e[r]}var pn={};function gn(t,e,r){var i=t+"."+String(r);if(pn[i])return pn[i].bind(e);var n=vn(t)[r];return"function"!=typeof n?e[r]:(pn[i]=n,n.bind(e))}var In={childNodes:function(t){return mn("Node",t,"childNodes")},parentNode:function(t){return mn("Node",t,"parentNode")},parentElement:function(t){return mn("Node",t,"parentElement")},textContent:function(t){return mn("Node",t,"textContent")},contains:function(t,e){return gn("Node",t,"contains")(e)},getRootNode:function(t){return gn("Node",t,"getRootNode")()},host:function(t){return t&&"host"in t?mn("ShadowRoot",t,"host"):null},styleSheets:function(t){return t.styleSheets},shadowRoot:function(t){return t&&"shadowRoot"in t?mn("Element",t,"shadowRoot"):null},querySelector:function(t,e){return mn("Element",t,"querySelector")(e)},querySelectorAll:function(t,e){return mn("Element",t,"querySelectorAll")(e)},mutationObserver:function(){return vn("MutationObserver").constructor}};class yn{constructor(){ln(this,"idNodeMap",new Map),ln(this,"nodeMetaMap",new WeakMap)}getId(t){var e;if(!t)return-1;var r=null==(e=this.getMeta(t))?void 0:e.id;return null!=r?r:-1}getNode(t){return this.idNodeMap.get(t)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(t){return this.nodeMetaMap.get(t)||null}removeNodeFromMap(t){var e=this.getId(t);this.idNodeMap.delete(e),t.childNodes&&t.childNodes.forEach((t=>this.removeNodeFromMap(t)))}has(t){return this.idNodeMap.has(t)}hasNode(t){return this.nodeMetaMap.has(t)}add(t,e){var r=e.id;this.idNodeMap.set(r,t),this.nodeMetaMap.set(t,e)}replace(t,e){var r=this.getNode(t);if(r){var i=this.nodeMetaMap.get(r);i&&this.nodeMetaMap.set(e,i)}this.idNodeMap.set(t,e)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function bn(t,e,r){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return!!r&&bn(In.parentNode(t),e,r);for(var i=t.classList.length;i--;){var n=t.classList[i];if(e.test(n))return!0}return!!r&&bn(In.parentNode(t),e,r)}class Cn{constructor(){__publicField22(this,"parentElement",null),__publicField22(this,"parentNode",null),__publicField22(this,"ownerDocument"),__publicField22(this,"firstChild",null),__publicField22(this,"lastChild",null),__publicField22(this,"previousSibling",null),__publicField22(this,"nextSibling",null),__publicField22(this,"ELEMENT_NODE",1),__publicField22(this,"TEXT_NODE",3),__publicField22(this,"nodeType"),__publicField22(this,"nodeName"),__publicField22(this,"RRNodeType")}get childNodes(){for(var t=[],e=this.firstChild;e;)t.push(e),e=e.nextSibling;return t}contains(t){if(!(t instanceof Cn))return!1;if(t.ownerDocument!==this.ownerDocument)return!1;if(t===this)return!0;for(;t.parentNode;){if(t.parentNode===this)return!0;t=t.parentNode}return!1}appendChild(t){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(t,e){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(t){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}var wn={Node:["childNodes","parentNode","parentElement","textContent"],ShadowRoot:["host","styleSheets"],Element:["shadowRoot","querySelector","querySelectorAll"],MutationObserver:[]},Sn={Node:["contains","getRootNode"],ShadowRoot:["getSelection"],Element:[],MutationObserver:["constructor"]},kn={};function An(t){if(kn[t])return kn[t];var e=globalThis[t],r=e.prototype,i=t in wn?wn[t]:void 0,n=Boolean(i&&i.every((t=>{var e,i;return Boolean(null==(i=null==(e=Object.getOwnPropertyDescriptor(r,t))?void 0:e.get)?void 0:i.toString().includes("[native code]"))}))),o=t in Sn?Sn[t]:void 0,s=Boolean(o&&o.every((t=>{var e;return"function"==typeof r[t]&&(null==(e=r[t])?void 0:e.toString().includes("[native code]"))})));if(n&&s)return kn[t]=e.prototype,e.prototype;try{var a=document.createElement("iframe");document.body.appendChild(a);var u=a.contentWindow;if(!u)return e.prototype;var l=u[t].prototype;return document.body.removeChild(a),l?kn[t]=l:r}catch(t){return r}}var Nn={};function Rn(t,e,r){var i,n=t+"."+String(r);if(Nn[n])return Nn[n].call(e);var o=An(t),s=null==(i=Object.getOwnPropertyDescriptor(o,r))?void 0:i.get;return s?(Nn[n]=s,s.call(e)):e[r]}var Tn={};function _n(t,e,r){var i=t+"."+String(r);if(Tn[i])return Tn[i].bind(e);var n=An(t)[r];return"function"!=typeof n?e[r]:(Tn[i]=n,n.bind(e))}var Mn={childNodes:function(t){return Rn("Node",t,"childNodes")},parentNode:function(t){return Rn("Node",t,"parentNode")},parentElement:function(t){return Rn("Node",t,"parentElement")},textContent:function(t){return Rn("Node",t,"textContent")},contains:function(t,e){return _n("Node",t,"contains")(e)},getRootNode:function(t){return _n("Node",t,"getRootNode")()},host:function(t){return t&&"host"in t?Rn("ShadowRoot",t,"host"):null},styleSheets:function(t){return t.styleSheets},shadowRoot:function(t){return t&&"shadowRoot"in t?Rn("Element",t,"shadowRoot"):null},querySelector:function(t,e){return Rn("Element",t,"querySelector")(e)},querySelectorAll:function(t,e){return Rn("Element",t,"querySelectorAll")(e)},mutationObserver:function(){return An("MutationObserver").constructor}};var Fn="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",Bn={map:{},getId:()=>(console.error(Fn),-1),getNode:()=>(console.error(Fn),null),removeNodeFromMap(){console.error(Fn)},has:()=>(console.error(Fn),!1),reset(){console.error(Fn)}};"undefined"!=typeof window&&window.Proxy&&window.Reflect&&(Bn=new Proxy(Bn,{get:(t,e,r)=>("map"===e&&console.error(Fn),Reflect.get(t,e,r))}));var On=Date.now;function xn(t){return t?t.nodeType===t.ELEMENT_NODE?t:Mn.parentElement(t):null}/[1-9][0-9]{12}/.test(Date.now().toString())||(On=()=>(new Date).getTime());function Zn(t){var e,r=null;return"getRootNode"in t&&(null==(e=Mn.getRootNode(t))?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&Mn.host(Mn.getRootNode(t))&&(r=Mn.host(Mn.getRootNode(t))),r}function Yn(t){for(var e,r=t;e=Zn(r);)r=e;return r}function En(t){var e=t.ownerDocument;if(!e)return!1;var r=Yn(t);return Mn.contains(e,r)}for(var Gn=Object.freeze(Object.defineProperty({__proto__:null,StyleSheetMirror:class{constructor(){an(this,"id",1),an(this,"styleIDMap",new WeakMap),an(this,"idStyleMap",new Map)}getId(t){var e;return null!==(e=this.styleIDMap.get(t))&&void 0!==e?e:-1}has(t){return this.styleIDMap.has(t)}add(t,e){return this.has(t)?this.getId(t):(r=void 0===e?this.id++:e,this.styleIDMap.set(t,r),this.idStyleMap.set(r,t),r);var r}getStyle(t){return this.idStyleMap.get(t)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}},get _mirror(){return Bn},closestElementOfNode:xn,getBaseDimension:function t(e,r){var i,n,o=null==(n=null==(i=e.ownerDocument)?void 0:i.defaultView)?void 0:n.frameElement;if(!o||o===r)return{x:0,y:0,relativeScale:1,absoluteScale:1};var s=o.getBoundingClientRect(),a=t(o,r),u=s.height/o.clientHeight;return{x:s.x*a.relativeScale+a.x,y:s.y*a.relativeScale+a.y,relativeScale:u,absoluteScale:a.absoluteScale*u}},getNestedRule:function t(e,r){var i=e[r[0]];return 1===r.length?i:t(i.cssRules[r[1]].cssRules,r.slice(2))},getPositionsAndIndex:function(t){var e=[...t],r=e.pop();return{positions:e,index:r}},getRootShadowHost:Yn,getShadowHost:Zn,getWindowHeight:function(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight},getWindowScroll:function(t){var e,r,i,n,o=t.document;return{left:o.scrollingElement?o.scrollingElement.scrollLeft:void 0!==t.pageXOffset?t.pageXOffset:o.documentElement.scrollLeft||(null==o?void 0:o.body)&&(null==(e=Mn.parentElement(o.body))?void 0:e.scrollLeft)||(null==(r=null==o?void 0:o.body)?void 0:r.scrollLeft)||0,top:o.scrollingElement?o.scrollingElement.scrollTop:void 0!==t.pageYOffset?t.pageYOffset:(null==o?void 0:o.documentElement.scrollTop)||(null==o?void 0:o.body)&&(null==(i=Mn.parentElement(o.body))?void 0:i.scrollTop)||(null==(n=null==o?void 0:o.body)?void 0:n.scrollTop)||0}},getWindowWidth:function(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth},hasShadowRoot:function(t){return!!t&&(t instanceof Cn&&"shadowRoot"in t?Boolean(t.shadowRoot):Boolean(Mn.shadowRoot(t)))},hookSetter:function t(e,r,i,n,o){void 0===o&&(o=window);var s=o.Object.getOwnPropertyDescriptor(e,r);return o.Object.defineProperty(e,r,n?i:{set(t){setTimeout((()=>{i.set.call(this,t)}),0),s&&s.set&&s.set.call(this,t)}}),()=>t(e,r,s||{},!0)},inDom:function(t){var e=t.ownerDocument;return!!e&&(Mn.contains(e,t)||En(t))},isAncestorRemoved:function t(e,r){if(n=(i=e)&&"host"in i&&"mode"in i&&In.host(i)||null,Boolean(n&&"shadowRoot"in n&&In.shadowRoot(n)===i))return!1;var i,n,o=r.getId(e);if(!r.has(o))return!0;var s=Mn.parentNode(e);return(!s||s.nodeType!==e.DOCUMENT_NODE)&&(!s||t(s,r))},isBlocked:function(t,e,r,i){if(!t)return!1;var n=xn(t);if(!n)return!1;try{if("string"==typeof e){if(n.classList.contains(e))return!0;if(i&&null!==n.closest("."+e))return!0}else if(bn(n,e,i))return!0}catch(t){}if(r){if(n.matches(r))return!0;if(i&&null!==n.closest(r))return!0}return!1},isIgnored:function(t,e,r){return!("TITLE"!==t.tagName||!r.headTitleMutations)||-2===e.getId(t)},isSerialized:function(t,e){return-1!==e.getId(t)},isSerializedIframe:function(t,e){return Boolean("IFRAME"===t.nodeName&&e.getMeta(t))},isSerializedStylesheet:function(t,e){return Boolean("LINK"===t.nodeName&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&"stylesheet"===t.getAttribute("rel")&&e.getMeta(t))},iterateResolveTree:function t(e,r){r(e.value);for(var i=e.children.length-1;i>=0;i--)t(e.children[i],r)},legacy_isTouchEvent:function(t){return Boolean(t.changedTouches)},get nowTimestamp(){return On},on:function(t,e,r){void 0===r&&(r=document);var i={capture:!0,passive:!0};return r.addEventListener(t,e,i),()=>r.removeEventListener(t,e,i)},patch:function(t,e,r){try{if(!(e in t))return()=>{};var i=t[e],n=r(i);return"function"==typeof n&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__rrweb_original__:{enumerable:!1,value:i}})),t[e]=n,()=>{t[e]=i}}catch(t){return()=>{}}},polyfill:function(t){void 0===t&&(t=window),"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach)},queueToResolveTrees:function(t){var e={},r=(t,r)=>{var i={value:t,parent:r,children:[]};return e[t.node.id]=i,i},i=[];for(var n of t){var{nextId:o,parentId:s}=n;if(o&&o in e){var a=e[o];if(a.parent){var u=a.parent.children.indexOf(a);a.parent.children.splice(u,0,r(n,a.parent))}else{var l=i.indexOf(a);i.splice(l,0,r(n,null))}}else if(s in e){var d=e[s];d.children.push(r(n,d))}else i.push(r(n,null))}return i},shadowHostInDom:En,throttle:function(t,e,r){void 0===r&&(r={});var i=null,n=0;return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];var u=Date.now();n||!1!==r.leading||(n=u);var l=e-(u-n),d=this;l<=0||l>e?(i&&(clearTimeout(i),i=null),n=u,t.apply(d,s)):i||!1===r.trailing||(i=setTimeout((()=>{n=!1===r.leading?0:Date.now(),i=null,t.apply(d,s)}),l))}},uniqueTextMutations:function(t){for(var e=new Set,r=[],i=t.length;i--;){var n=t[i];e.has(n.id)||(r.push(n),e.add(n.id))}return r}},Symbol.toStringTag,{value:"Module"})),Ln="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wn="undefined"==typeof Uint8Array?[]:new Uint8Array(256),Dn=0;Dn<64;Dn++)Wn[Ln.charCodeAt(Dn)]=Dn;var Vn;"undefined"!=typeof window&&window.Blob&&new Blob([(t=>Uint8Array.from(atob(t),(t=>t.charCodeAt(0))))("KGZ1bmN0aW9uKCkgewogICJ1c2Ugc3RyaWN0IjsKICB2YXIgY2hhcnMgPSAiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyI7CiAgdmFyIGxvb2t1cCA9IHR5cGVvZiBVaW50OEFycmF5ID09PSAidW5kZWZpbmVkIiA/IFtdIDogbmV3IFVpbnQ4QXJyYXkoMjU2KTsKICBmb3IgKHZhciBpID0gMDsgaSA8IGNoYXJzLmxlbmd0aDsgaSsrKSB7CiAgICBsb29rdXBbY2hhcnMuY2hhckNvZGVBdChpKV0gPSBpOwogIH0KICB2YXIgZW5jb2RlID0gZnVuY3Rpb24oYXJyYXlidWZmZXIpIHsKICAgIHZhciBieXRlcyA9IG5ldyBVaW50OEFycmF5KGFycmF5YnVmZmVyKSwgaTIsIGxlbiA9IGJ5dGVzLmxlbmd0aCwgYmFzZTY0ID0gIiI7CiAgICBmb3IgKGkyID0gMDsgaTIgPCBsZW47IGkyICs9IDMpIHsKICAgICAgYmFzZTY0ICs9IGNoYXJzW2J5dGVzW2kyXSA+PiAyXTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMl0gJiAzKSA8PCA0IHwgYnl0ZXNbaTIgKyAxXSA+PiA0XTsKICAgICAgYmFzZTY0ICs9IGNoYXJzWyhieXRlc1tpMiArIDFdICYgMTUpIDw8IDIgfCBieXRlc1tpMiArIDJdID4+IDZdOwogICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaTIgKyAyXSAmIDYzXTsKICAgIH0KICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgIj0iOwogICAgfSBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgIj09IjsKICAgIH0KICAgIHJldHVybiBiYXNlNjQ7CiAgfTsKICBjb25zdCBsYXN0QmxvYk1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7CiAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTsKICBhc3luYyBmdW5jdGlvbiBnZXRUcmFuc3BhcmVudEJsb2JGb3Iod2lkdGgsIGhlaWdodCwgZGF0YVVSTE9wdGlvbnMpIHsKICAgIGNvbnN0IGlkID0gYCR7d2lkdGh9LSR7aGVpZ2h0fWA7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBpZiAodHJhbnNwYXJlbnRCbG9iTWFwLmhhcyhpZCkpIHJldHVybiB0cmFuc3BhcmVudEJsb2JNYXAuZ2V0KGlkKTsKICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsKICAgICAgb2Zmc2NyZWVuLmdldENvbnRleHQoIjJkIik7CiAgICAgIGNvbnN0IGJsb2IgPSBhd2FpdCBvZmZzY3JlZW4uY29udmVydFRvQmxvYihkYXRhVVJMT3B0aW9ucyk7CiAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpOwogICAgICBjb25zdCBiYXNlNjQgPSBlbmNvZGUoYXJyYXlCdWZmZXIpOwogICAgICB0cmFuc3BhcmVudEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICByZXR1cm4gYmFzZTY0OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICIiOwogICAgfQogIH0KICBjb25zdCB3b3JrZXIgPSBzZWxmOwogIHdvcmtlci5vbm1lc3NhZ2UgPSBhc3luYyBmdW5jdGlvbihlKSB7CiAgICBpZiAoIk9mZnNjcmVlbkNhbnZhcyIgaW4gZ2xvYmFsVGhpcykgewogICAgICBjb25zdCB7IGlkLCBiaXRtYXAsIHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zIH0gPSBlLmRhdGE7CiAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKAogICAgICAgIHdpZHRoLAogICAgICAgIGhlaWdodCwKICAgICAgICBkYXRhVVJMT3B0aW9ucwogICAgICApOwogICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOwogICAgICBjb25zdCBjdHggPSBvZmZzY3JlZW4uZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3R4LmRyYXdJbWFnZShiaXRtYXAsIDAsIDApOwogICAgICBiaXRtYXAuY2xvc2UoKTsKICAgICAgY29uc3QgYmxvYiA9IGF3YWl0IG9mZnNjcmVlbi5jb252ZXJ0VG9CbG9iKGRhdGFVUkxPcHRpb25zKTsKICAgICAgY29uc3QgdHlwZSA9IGJsb2IudHlwZTsKICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCBibG9iLmFycmF5QnVmZmVyKCk7CiAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7CiAgICAgIGlmICghbGFzdEJsb2JNYXAuaGFzKGlkKSAmJiBhd2FpdCB0cmFuc3BhcmVudEJhc2U2NCA9PT0gYmFzZTY0KSB7CiAgICAgICAgbGFzdEJsb2JNYXAuc2V0KGlkLCBiYXNlNjQpOwogICAgICAgIHJldHVybiB3b3JrZXIucG9zdE1lc3NhZ2UoeyBpZCB9KTsKICAgICAgfQogICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KSByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7CiAgICAgIHdvcmtlci5wb3N0TWVzc2FnZSh7CiAgICAgICAgaWQsCiAgICAgICAgdHlwZSwKICAgICAgICBiYXNlNjQsCiAgICAgICAgd2lkdGgsCiAgICAgICAgaGVpZ2h0CiAgICAgIH0pOwogICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsKICAgIH0KICB9Owp9KSgpOwovLyMgc291cmNlTWFwcGluZ1VSTD1pbWFnZS1iaXRtYXAtZGF0YS11cmwtd29ya2VyLUlKcEM3Z19iLmpzLm1hcAo=")],{type:"text/javascript;charset=utf-8"});try{if(2!==Array.from([1],(t=>2*t))[0]){var Xn=document.createElement("iframe");document.body.appendChild(Xn),Array.from=(null==(rn=Xn.contentWindow)?void 0:rn.Array.from)||Array.from,document.body.removeChild(Xn)}}catch(t){console.debug("Unable to override Array.from",t)}new yn,function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(Vn||(Vn={}));class zn{constructor(t){on(this,"fileName"),on(this,"functionName"),on(this,"lineNumber"),on(this,"columnNumber"),this.fileName=t.fileName||"",this.functionName=t.functionName||"",this.lineNumber=t.lineNumber,this.columnNumber=t.columnNumber}toString(){var t=this.lineNumber||"",e=this.columnNumber||"";return this.functionName?this.functionName+" ("+this.fileName+":"+t+":"+e+")":this.fileName+":"+t+":"+e}}var Jn=/(^|@)\S+:\d+/,Kn=/^\s*at .*(\S+:\d+|\(native\))/m,Hn=/^(eval@)?(\[native code])?$/,jn={parse:function(t){return t?void 0!==t.stacktrace||void 0!==t["opera#sourceloc"]?this.parseOpera(t):t.stack&&t.stack.match(Kn)?this.parseV8OrIE(t):t.stack?this.parseFFOrSafari(t):(console.warn("[console-record-plugin]: Failed to parse error object:",t),[]):[]},extractLocation:function(t){if(-1===t.indexOf(":"))return[t];var e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(t.replace(/[()]/g,""));if(!e)throw new Error("Cannot parse given url: "+t);return[e[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(Kn)}),this).map((function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));var e=t.replace(/^\s+/,"").replace(/\(eval code/g,"("),r=e.match(/ (\((.+):(\d+):(\d+)\)$)/),i=(e=r?e.replace(r[0],""):e).split(/\s+/).slice(1),n=this.extractLocation(r?r[1]:i.pop()),o=i.join(" ")||void 0,s=["eval","<anonymous>"].indexOf(n[0])>-1?void 0:n[0];return new zn({functionName:o,fileName:s,lineNumber:n[1],columnNumber:n[2]})}),this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter((function(t){return!t.match(Hn)}),this).map((function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new zn({functionName:t});var e=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(e),i=r&&r[1]?r[1]:void 0,n=this.extractLocation(t.replace(e,""));return new zn({functionName:i,fileName:n[0],lineNumber:n[1],columnNumber:n[2]})}),this)},parseOpera:function(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?this.parseOpera9(t):t.stack?this.parseOpera11(t):this.parseOpera10(t)},parseOpera9:function(t){for(var e=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),i=[],n=2,o=r.length;n<o;n+=2){var s=e.exec(r[n]);s&&i.push(new zn({fileName:s[2],lineNumber:parseFloat(s[1])}))}return i},parseOpera10:function(t){for(var e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),i=[],n=0,o=r.length;n<o;n+=2){var s=e.exec(r[n]);s&&i.push(new zn({functionName:s[3]||void 0,fileName:s[2],lineNumber:parseFloat(s[1])}))}return i},parseOpera11:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(Jn)&&!t.match(/^Error created at/)}),this).map((function(t){var e=t.split("@"),r=this.extractLocation(e.pop()),i=(e.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new zn({functionName:i,fileName:r[0],lineNumber:r[1],columnNumber:r[2]})}),this)}};function Un(t){if(!t||!t.outerHTML)return"";for(var e="";t.parentElement;){var r=t.localName;if(!r)break;r=r.toLowerCase();var i=t.parentElement,n=[];if(i.children&&i.children.length>0)for(var o=0;o<i.children.length;o++){var s=i.children[o];s.localName&&s.localName.toLowerCase&&s.localName.toLowerCase()===r&&n.push(s)}n.length>1&&(r+=":eq("+n.indexOf(t)+")"),e=r+(e?">"+e:""),t=i}return e}function Pn(t){return"[object Object]"===Object.prototype.toString.call(t)}function qn(t,e){if(0===e)return!0;var r=Object.keys(t);for(var i of r)if(Pn(t[i])&&qn(t[i],e-1))return!0;return!1}function Qn(t,e){var r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,e);var i=[],n=[];return JSON.stringify(t,(function(t,e){if(i.length>0){var o=i.indexOf(this);~o?i.splice(o+1):i.push(this),~o?n.splice(o,1/0,t):n.push(t),~i.indexOf(e)&&(e=i[0]===e?"[Circular ~]":"[Circular ~."+n.slice(0,i.indexOf(e)).join(".")+"]")}else i.push(e);if(null===e)return e;if(void 0===e)return"undefined";if(function(t){if(Pn(t)&&Object.keys(t).length>r.numOfKeysLimit)return!0;if("function"==typeof t)return!0;if(Pn(t)&&qn(t,r.depthOfLimit))return!0;return!1}(e))return function(t){var e=t.toString();r.stringLengthLimit&&e.length>r.stringLengthLimit&&(e=e.slice(0,r.stringLengthLimit)+"...");return e}(e);if("bigint"==typeof e)return e.toString()+"n";if(e instanceof Event){var s={};for(var a in e){var u=e[a];Array.isArray(u)?s[a]=Un(u.length?u[0]:null):s[a]=u}return s}return e instanceof Node?e instanceof HTMLElement?e?e.outerHTML:"":e.nodeName:e instanceof Error?e.stack?e.stack+"\nEnd of stack for Error object":e.name+": "+e.message:e}))}var $n={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function to(t,e,r){var i,n=r?Object.assign({},$n,r):$n,o=n.logger;if(!o)return()=>{};i="string"==typeof o?e[o]:o;var s=0,a=!1,u=[];if(n.level.includes("error")){var l=e=>{var r=e.message,i=e.error,o=jn.parse(i).map((t=>t.toString())),s=[Qn(r,n.stringifyOptions)];t({level:"error",trace:o,payload:s})};e.addEventListener("error",l),u.push((()=>{e.removeEventListener("error",l)}));var d=e=>{var r,i;e.reason instanceof Error?i=[Qn("Uncaught (in promise) "+(r=e.reason).name+": "+r.message,n.stringifyOptions)]:(r=new Error,i=[Qn("Uncaught (in promise)",n.stringifyOptions),Qn(e.reason,n.stringifyOptions)]);var o=jn.parse(r).map((t=>t.toString()));t({level:"error",trace:o,payload:i})};e.addEventListener("unhandledrejection",d),u.push((()=>{e.removeEventListener("unhandledrejection",d)}))}for(var c of n.level)u.push(h(i,c));return()=>{u.forEach((t=>t()))};function h(e,r){var i=this;return e[r]?Gn.patch(e,r,(e=>function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];if(e.apply(i,u),!("assert"===r&&u[0]||a)){a=!0;try{var d=jn.parse(new Error).map((t=>t.toString())).splice(1),c=("assert"===r?u.slice(1):u).map((t=>Qn(t,n.stringifyOptions)));++s<n.lengthThreshold?t({level:r,trace:d,payload:c}):s===n.lengthThreshold&&t({level:"warn",trace:[],payload:[Qn("The number of log records reached the threshold.")]})}catch(t){e("rrweb logger error:",t,...u)}finally{a=!1}}})):()=>{}}}var eo=t=>({name:"rrweb/console@1",observer:to,options:t}),ro=t=>t instanceof Document;function io(t,e,r){try{if(!(e in t))return()=>{};var i=t[e],n=r(i);return g(n)&&(n.prototype=n.prototype||{},Object.defineProperties(n,{__posthog_wrapped__:{enumerable:!1,value:!0}})),t[e]=n,()=>{t[e]=i}}catch(t){return()=>{}}}function no(t,e){var r,i=function(t){try{return"string"==typeof t?new URL(t).hostname:"url"in t?new URL(t.url).hostname:t.hostname}catch(t){return null}}(t),n={hostname:i,isHostDenied:!1};if(null==(r=e.payloadHostDenyList)||!r.length||null==i||!i.trim().length)return n;for(var o of e.payloadHostDenyList)if(i.endsWith(o))return{hostname:i,isHostDenied:!0};return n}var oo=F("[Recorder]"),so=t=>"navigation"===t.entryType,ao=t=>"resource"===t.entryType;function uo(t,e,r){if(r.recordInitialRequests){var i=e.performance.getEntries().filter((t=>so(t)||ao(t)&&r.initiatorTypes.includes(t.initiatorType)));t({requests:i.flatMap((t=>po({entry:t,method:void 0,status:void 0,networkRequest:{},isInitial:!0}))),isInitial:!0})}var n=new e.PerformanceObserver((e=>{var i=e.getEntries().filter((t=>so(t)||ao(t)&&r.initiatorTypes.includes(t.initiatorType)&&(t=>!r.recordBody&&!r.recordHeaders||"xmlhttprequest"!==t.initiatorType&&"fetch"!==t.initiatorType)(t)));t({requests:i.flatMap((t=>po({entry:t,method:void 0,status:void 0,networkRequest:{}})))})})),o=PerformanceObserver.supportedEntryTypes.filter((t=>r.performanceEntryTypeToObserve.includes(t)));return n.observe({entryTypes:o}),()=>{n.disconnect()}}function lo(t,e){return!!e&&(k(e)||e[t])}function co(t){var{type:e,recordBody:r,headers:i,url:n}=t;function o(t){var e=Object.keys(i).find((t=>"content-type"===t.toLowerCase())),r=e&&i[e];return t.some((t=>null==r?void 0:r.includes(t)))}if(!r)return!1;if(function t(e){try{return"string"==typeof e?e.startsWith("blob:"):e instanceof URL?"blob:"===e.protocol:e instanceof Request&&t(e.url)}catch(t){return!1}}(n))return!1;if(k(r))return!0;if(p(r))return o(r);var s=r[e];return k(s)?s:o(s)}function ho(t,e,r,i,n,o){return vo.apply(this,arguments)}function vo(){return vo=a((function*(t,e,r,i,n,o){if(void 0===o&&(o=0),o>10)return oo.warn("Failed to get performance entry for request",{url:r,initiatorType:e}),null;var s=function(t,e){for(var r=t.length-1;r>=0;r-=1)if(e(t[r]))return t[r]}(t.performance.getEntriesByName(r),(t=>ao(t)&&t.initiatorType===e&&(y(i)||t.startTime>=i)&&(y(n)||t.startTime<=n)));return s||(yield new Promise((t=>setTimeout(t,50*o))),ho(t,e,r,i,n,o+1))})),vo.apply(this,arguments)}function fo(t){var{body:e,options:r,url:i}=t;if(w(e))return null;var{hostname:n,isHostDenied:o}=no(i,r);if(o)return n+" is in deny list";if(b(e))return e;if(ro(e))return e.textContent;if(A(e))return E(e);if(I(e))try{return JSON.stringify(e)}catch(t){return"[SessionReplay] Failed to stringify response object"}return"[SessionReplay] Cannot read body of type "+toString.call(e)}var mo=t=>!C(t)&&("navigation"===t.entryType||"resource"===t.entryType);function po(t){var{entry:e,method:r,status:i,networkRequest:n,isInitial:o,start:s,end:a,url:l,initiatorType:d}=t;s=e?e.startTime:s,a=e?e.responseEnd:a;var c=Math.floor(Date.now()-performance.now()),h=Math.floor(c+(s||0)),v=[u({},e?e.toJSON():{name:l},{startTime:y(s)?void 0:Math.round(s),endTime:y(a)?void 0:Math.round(a),timeOrigin:c,timestamp:h,method:r,initiatorType:d||(e?e.initiatorType:void 0),status:i,requestHeaders:n.requestHeaders,requestBody:n.requestBody,responseHeaders:n.responseHeaders,responseBody:n.responseBody,isInitial:o})];if(mo(e))for(var f of e.serverTiming||[])v.push({timeOrigin:c,timestamp:h,startTime:Math.round(e.startTime),name:f.name,duration:f.duration,entryType:"serverTiming"});return v}var go=["video/","audio/"];function Io(t){return new Promise(((e,r)=>{var i=setTimeout((()=>e("[SessionReplay] Timeout while trying to read body")),500);try{t.clone().text().then((t=>e(t)),(t=>r(t))).finally((()=>clearTimeout(i)))}catch(t){clearTimeout(i),e("[SessionReplay] Failed to read body")}}))}function yo(){return(yo=a((function*(t){var{r:e,options:r,url:i}=t,{hostname:n,isHostDenied:o}=no(i,r);return o?Promise.resolve(n+" is in deny list"):Io(e)}))).apply(this,arguments)}function bo(){return(bo=a((function*(t){var{r:e,options:r,url:i}=t,n=function(t){var e,{r:r,options:i,url:n}=t;if("chunked"===r.headers.get("Transfer-Encoding"))return"Chunked Transfer-Encoding is not supported";var o=null==(e=r.headers.get("Content-Type"))?void 0:e.toLowerCase(),s=go.some((t=>null==o?void 0:o.startsWith(t)));if(o&&s)return"Content-Type "+o+" is not supported";var{hostname:a,isHostDenied:u}=no(n,i);return u?a+" is in deny list":null}({r:e,options:r,url:i});return C(n)?Io(e):Promise.resolve(n)}))).apply(this,arguments)}function Co(t,e,r){if(!r.initiatorTypes.includes("fetch"))return()=>{};var i=lo("request",r.recordHeaders),n=lo("response",r.recordHeaders),o=io(e,"fetch",(o=>function(){var s=a((function*(s,a){var u,l,d,c=new Request(s,a),h={};try{var v={};c.headers.forEach(((t,e)=>{v[e]=t})),i&&(h.requestHeaders=v),co({type:"request",headers:v,url:s,recordBody:r.recordBody})&&(h.requestBody=yield function(t){return yo.apply(this,arguments)}({r:c,options:r,url:s})),l=e.performance.now(),u=yield o(c),d=e.performance.now();var f={};return u.headers.forEach(((t,e)=>{f[e]=t})),n&&(h.responseHeaders=f),co({type:"response",headers:f,url:s,recordBody:r.recordBody})&&(h.responseBody=yield function(t){return bo.apply(this,arguments)}({r:u,options:r,url:s})),u}finally{ho(e,"fetch",c.url,l,d).then((e=>{var r,i=po({entry:e,method:c.method,status:null==(r=u)?void 0:r.status,networkRequest:h,start:l,end:d,url:c.url,initiatorType:"fetch"});t({requests:i})})).catch((()=>{}))}}));return function(t,e){return s.apply(this,arguments)}}()));return()=>{o()}}var wo=null;function So(t,e,r){if(!("performance"in e))return()=>{};if(wo)return oo.warn("Network observer already initialised, doing nothing"),()=>{};var i=r?Object.assign({},H,r):H,n=e=>{var r=[];e.requests.forEach((t=>{var e=i.maskRequestFn(t);e&&r.push(e)})),r.length>0&&t(u({},e,{requests:r}))},o=uo(n,e,i),s=()=>{},a=()=>{};return(i.recordHeaders||i.recordBody)&&(s=function(t,e,r){if(!r.initiatorTypes.includes("xmlhttprequest"))return()=>{};var i=lo("request",r.recordHeaders),n=lo("response",r.recordHeaders),o=io(e.XMLHttpRequest.prototype,"open",(o=>function(s,a,u,l,d){void 0===u&&(u=!0);var c,h,v=this,f=new Request(a),m={},p={},g=v.setRequestHeader.bind(v);v.setRequestHeader=(t,e)=>(p[t]=e,g(t,e)),i&&(m.requestHeaders=p);var I=v.send.bind(v);v.send=t=>(co({type:"request",headers:p,url:a,recordBody:r.recordBody})&&(m.requestBody=fo({body:t,options:r,url:a})),c=e.performance.now(),I(t));var y=()=>{v.removeEventListener("readystatechange",b),v.removeEventListener("error",y),v.removeEventListener("abort",y),v.removeEventListener("timeout",y)},b=()=>{if(v.readyState===v.DONE){y(),h=e.performance.now();var i={};v.getAllResponseHeaders().trim().split(/[\r\n]+/).forEach((t=>{var e=t.split(": "),r=e.shift(),n=e.join(": ");r&&(i[r]=n)})),n&&(m.responseHeaders=i),co({type:"response",headers:i,url:a,recordBody:r.recordBody})&&(m.responseBody=fo({body:v.response,options:r,url:a})),ho(e,"xmlhttprequest",f.url,c,h).then((e=>{var r=po({entry:e,method:s,status:null==v?void 0:v.status,networkRequest:m,start:c,end:h,url:a.toString(),initiatorType:"xmlhttprequest"});t({requests:r})})).catch((()=>{}))}};v.addEventListener("readystatechange",b),v.addEventListener("error",y),v.addEventListener("abort",y),v.addEventListener("timeout",y),o.call(v,s,a.toString(),u,l,d)}));return()=>{o()}}(n,e,i),a=Co(n,e,i)),wo=()=>{o(),s(),a(),wo=null}}var ko=t=>({name:"rrweb/network@1",observer:So,options:t});o.__PosthogExtensions__=o.__PosthogExtensions__||{},o.__PosthogExtensions__.rrwebPlugins={getRecordConsolePlugin:eo,getRecordNetworkPlugin:ko},o.__PosthogExtensions__.rrweb={record:en,version:"v2"},o.rrweb={record:en,version:"v2"},o.rrwebConsoleRecord={getRecordConsolePlugin:eo},o.getRecordNetworkPlugin=ko,o.__PosthogExtensions__=o.__PosthogExtensions__||{},o.__PosthogExtensions__.initSessionRecording=t=>new be(t)}();
//# sourceMappingURL=lazy-recorder.js.map
